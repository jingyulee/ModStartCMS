!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.COS=t():e.COS=t()}(this,function(){return c=[function(t,e){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},function(x,e,A){"use strict";!function(e){var o=A(0),r=A(12),l=A(15),t=A(16),n=A(21),d=A(6);function s(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}function p(e,t){var n,r=[];for(n in e)e.hasOwnProperty(n)&&r.push(t?s(n).toLowerCase():n);return r.sort(function(e,t){return(e=e.toLowerCase())===(t=t.toLowerCase())?0:t<e?1:-1})}function m(e,t,n){return n=e.slice(n,n+t/8),new Uint8Array(n).reverse(),new{8:Uint8Array,16:Uint16Array,32:Uint32Array}[t](n)[0]}function g(e,t,n,r){var n=e.slice(t,n),o="";return new Uint8Array(n).forEach(function(e){o+=String.fromCharCode(e)}),o=r?decodeURIComponent(escape(o)):o}function i(){}function a(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&void 0!==e[t]&&null!==e[t]&&(n[t]=e[t]);return n}var c,h=["cache-control","content-disposition","content-encoding","content-length","content-md5","expect","expires","host","if-match","if-modified-since","if-none-match","if-unmodified-since","origin","range","transfer-encoding"],u=(c=function(e,t){e=e.split("."),t=t.split(".");for(var n=0;n<t.length;n++)if(e[n]!==t[n])return parseInt(e[n])>parseInt(t[n])?1:-1;return 0},function(e){if(!e)return!1;var t=(e.match(/Chrome\/([.\d]+)/)||[])[1],n=(e.match(/QBCore\/([.\d]+)/)||[])[1],e=(e.match(/QQBrowser\/([.\d]+)/)||[])[1];return t&&c(t,"53.0.2785.116")<0&&n&&c(n,"3.53.991.400")<0&&e&&c(e,"9.0.2524.400")<=0||!1}("undefined"!=typeof navigator&&navigator.userAgent)),f=1048576;function y(e){return S(e,function(e){return"object"===o(e)&&null!==e?y(e):e})}function v(n,r){return k(r,function(e,t){n[t]=r[t]}),n}function C(e){return e instanceof Array}function k(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function S(e,t){var n,r=C(e)?[]:{};for(n in e)e.hasOwnProperty(n)&&(r[n]=t(e[n],n));return r}function b(e,n){var r;return n=v({},n),"getAuth"!==e&&"getV4Auth"!==e&&"getObjectUrl"!==e&&(r=n.Headers||{},n&&"object"===o(n)&&(function(){for(var e in n)n.hasOwnProperty(e)&&-1<e.indexOf("x-cos-")&&(r[e]=n[e])}(),w.each({"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-traffic-limit":"TrafficLimit","x-cos-mime-limit":"MimeLimit","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext","Pic-Operations":"PicOperations"},function(e,t){void 0!==n[e]&&(r[t]=n[e])}),n.Headers=a(r))),n}function T(e){return Date.now()+(e||0)}var R="object"===("undefined"==typeof navigator?"undefined":o(navigator))&&!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),E="object"===("undefined"==typeof navigator?"undefined":o(navigator))&&/\sQQ/i.test(navigator.userAgent),w={noop:i,formatParams:b,apiWrapper:function(u,l){return function(t,o){var n,i=this;"function"==typeof t&&(o=t,t={}),t=b(u,t),i.options.EnableTracker&&(n="sliceUploadFile"===t.calledBySdk?t.tracker&&t.tracker.generateSubTracker({apiName:u}):["uploadFile","uploadFiles"].includes(u)?null:(c=-1,t.Body&&(c="string"==typeof t.Body?t.Body.length:t.Body.size||t.Body.byteLength||-1),new d({bucket:t.Bucket,region:t.Region,apiName:u,fileKey:t.Key,fileSize:c,deepTracker:i.options.DeepTracker,customId:i.options.CustomId,delay:i.options.TrackerDelay}))),t.tracker=n;function r(e){return e&&e.headers&&(e.headers["x-cos-request-id"]&&(e.RequestId=e.headers["x-cos-request-id"]),e.headers["x-ci-request-id"]&&(e.RequestId=e.headers["x-ci-request-id"]),e.headers["x-cos-version-id"]&&(e.VersionId=e.headers["x-cos-version-id"]),e.headers["x-cos-delete-marker"]&&(e.DeleteMarker=e.headers["x-cos-delete-marker"])),e}function e(e,t){n&&n.formatResult(e,t),o&&o(r(e),r(t))}var a=function(){if("getService"!==u&&"abortUploadTask"!==u){var e=function(e,t){var n=t.Bucket,r=t.Region,o=t.Key,i=this.options.Domain,t=!i||"string"==typeof i&&-1<i.indexOf("{Bucket}"),i=!i||"string"==typeof i&&-1<i.indexOf("{Region}");if(-1<e.indexOf("Bucket")||"deleteMultipleObject"===e||"multipartList"===e||"listObjectVersions"===e){if(t&&!n)return"Bucket";if(i&&!r)return"Region"}else if(-1<e.indexOf("Object")||-1<e.indexOf("multipart")||"sliceUploadFile"===e||"abortUploadTask"===e){if(t&&!n)return"Bucket";if(i&&!r)return"Region";if(!o)return"Key"}return!1}.call(i,u,t);if(e)return"missing param "+e;if(t.Region){if(i.options.CompatibilityMode){if(!/^([a-z\d-.]+)$/.test(t.Region))return"Region format error."}else{if(-1<t.Region.indexOf("cos."))return'param Region should not be start with "cos."';if(!/^([a-z\d-]+)$/.test(t.Region))return"Region format error."}i.options.CompatibilityMode||-1!==t.Region.indexOf("-")||"yfb"===t.Region||"default"===t.Region||t.Region}if(t.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(t.Bucket))if(t.AppId)t.Bucket=t.Bucket+"-"+t.AppId;else{if(!i.options.AppId)return'Bucket should format as "test-1250000000".';t.Bucket=t.Bucket+"-"+i.options.AppId}t.AppId&&delete t.AppId}!i.options.UseRawKey&&t.Key&&"/"===t.Key.substr(0,1)&&(t.Key=t.Key.substr(1))}}(),s=["getAuth","getObjectUrl"].includes(u);if("function"==typeof Promise&&!s&&!o)return new Promise(function(n,r){if(o=function(e,t){e?r(e):n(t)},a)return e(w.error(new Error(a)));l.call(i,t,e)});if(a)return e(w.error(new Error(a)));var c=l.call(i,t,e);return s?c:void 0}},xml2json:t,json2xml:n,md5:r,clearKey:a,fileSlice:function(e,t,n,r,o){var i,a;e.slice?i=e.slice(t,n):e.mozSlice?i=e.mozSlice(t,n):e.webkitSlice&&(i=e.webkitSlice(t,n)),r&&u?((a=new FileReader).onload=function(e){i=null,o(new Blob([a.result]))},a.readAsArrayBuffer(i)):o(i)},getBodyMd5:function(e,t,n,r){n=n||i,e?"string"==typeof t?n(w.md5(t,!0)):Blob&&t instanceof Blob?w.getFileMd5(t,function(e,t){n(t)},r):n():n()},getFileMd5:function(t,n,s){var c=t.size,u=0,l=r.getCtx();!function o(i){var e;c<=i?(e=l.digest("hex"),n(null,e)):(e=Math.min(c,i+f),w.fileSlice(t,i,e,!1,function(t){var e,a,n,r;e=t,a=function(e){t=null,l=l.update(e,!0),u+=e.length,e=null,s&&s({loaded:u,total:c,percent:Math.round(u/c*1e4)/1e4}),o(i+f)},r=new FileReader,FileReader.prototype.readAsBinaryString?(n=FileReader.prototype.readAsBinaryString,r.onload=function(){a(this.result)}):FileReader.prototype.readAsArrayBuffer&&(n=function(e){var o="",i=new FileReader;i.onload=function(e){for(var t=new Uint8Array(i.result),n=t.byteLength,r=0;r<n;r++)o+=String.fromCharCode(t[r]);a(o)},i.readAsArrayBuffer(e)}),n.call(r,e)}))}(0)},binaryBase64:function(e){for(var t,n="",r=0,o=e.length/2;r<o;r++)t=parseInt(e[2*r]+e[2*r+1],16),n+=String.fromCharCode(t);return btoa(n)},extend:v,isArray:C,isInArray:function(e,t){for(var n=!1,r=0;r<e.length;r++)if(t===e[r]){n=!0;break}return n},makeArray:function(e){return C(e)?e:[e]},each:k,map:S,filter:function(e,t){var n,r=C(e),o=r?[]:{};for(n in e)e.hasOwnProperty(n)&&t(e[n],n)&&(r?o.push(e[n]):o[n]=e[n]);return o},clone:y,attr:function(e,t,n){return e&&t in e?e[t]:n},uuid:function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},camSafeUrlEncode:s,throttleOnProgress:function(n,r){var o,i,a=this,s=0,c=0,u=Date.now();function l(){if(i=0,r&&"function"==typeof r){o=Date.now();var e=Math.max(0,Math.round((c-s)/((o-u)/1e3)*100)/100)||0,t=0===c&&0===n?1:Math.floor(c/n*100)/100||0;u=o,s=c;try{r({loaded:c,total:n,speed:e,percent:t})}catch(e){}}}return function(e,t){e&&(c=e.loaded,n=e.total),t?(clearTimeout(i),l()):i=i||setTimeout(l,a.options.ProgressInterval)}},getFileSize:function(e,t,n){var r;"string"==typeof t.Body?t.Body=new Blob([t.Body],{type:"text/plain"}):t.Body instanceof ArrayBuffer&&(t.Body=new Blob([t.Body])),t.Body&&(t.Body instanceof Blob||"[object File]"===t.Body.toString()||"[object Blob]"===t.Body.toString())?(r=t.Body.size,n(null,t.ContentLength=r)):n(w.error(new Error("params body format error, Only allow File|Blob|String.")))},getSkewTime:T,error:function(e,t){var n=e;return e.message=e.message||null,"string"==typeof t?(e.error=t,e.message=t):"object"===o(t)&&null!==t&&(v(e,t),(t.code||t.name)&&(e.code=t.code||t.name),t.message&&(e.message=t.message),t.stack&&(e.stack=t.stack)),"function"==typeof Object.defineProperty&&(Object.defineProperty(e,"name",{writable:!0,enumerable:!1}),Object.defineProperty(e,"message",{enumerable:!0})),e.name=t&&t.name||e.name||e.code||"Error",e.code||(e.code=e.name),e.error||(e.error=y(n)),e},obj2str:function(e,t){for(var n,r,o=[],i=p(e),a=0;a<i.length;a++)r=void 0===e[n=i[a]]||null===e[n]?"":""+e[n],n=t?s(n).toLowerCase():s(n),r=s(r)||"",o.push(n+"="+r);return o.join("&")},getAuth:function(e){var t,n=(e=e||{}).SecretId,r=e.SecretKey,o=e.KeyTime,i=(e.method||e.Method||"get").toLowerCase(),a=y(e.Query||e.params||{}),s=function(e){var t,n={};for(t in e){var r=t.toLowerCase();(-1<r.indexOf("x-cos-")||-1<h.indexOf(r))&&(n[t]=e[t])}return n}(y(e.Headers||e.headers||{})),c=e.Key||"";e.UseRawKey?t=e.Pathname||e.pathname||"/"+c:0!==(t=e.Pathname||e.pathname||c).indexOf("/")&&(t="/"+t);var u=!1!==e.ForceSignHost;if(!s.Host&&!s.host&&e.Bucket&&e.Region&&u&&(s.Host=e.Bucket+".cos."+e.Region+".myqcloud.com"),!n)throw new Error("missing param SecretId");if(!r)throw new Error("missing param SecretKey");c=Math.round(T(e.SystemClockOffset)/1e3)-1,u=c,e=e.Expires||e.expires;u+=void 0===e?900:+e||0;e=n,n=o||c+";"+u,o=o||c+";"+u,c=p(s,!0).join(";").toLowerCase(),u=p(a,!0).join(";").toLowerCase(),r=l.HmacSHA1(o,r).toString(),s=[i,t,w.obj2str(a,!0),w.obj2str(s,!0),""].join("\n"),s=["sha1",n,l.SHA1(s).toString(),""].join("\n");return["q-sign-algorithm=sha1","q-ak="+e,"q-sign-time="+n,"q-key-time="+o,"q-header-list="+c,"q-url-param-list="+u,"q-signature="+l.HmacSHA1(s,r).toString()].join("&")},parseSelectPayload:function(e){for(var t={},n=g(e),r={records:[]};e.byteLength;){var o,i,a,s=m(e,32,0),c=m(e,32,4),u=s-c-16,l=0;for(e=e.slice(12);l<c;){var d=m(e,8,l),p=g(e,l+1,l+1+d),h=m(e,16,l+d+2),f=g(e,l+d+4,l+d+4+h);t[p]=f,l+=d+4+h}"Records"===t[":event-type"]?(o=g(e,l,l+u,!0),r.records.push(o)):"Stats"===t[":event-type"]?(o=g(e,l,l+u,!0),r.stats=w.xml2json(o).Stats):"error"===t[":event-type"]?(i=t[":error-code"],a=t[":error-message"],(s=new Error(a)).message=a,s.name=s.code=i,r.error=s):["Progress","Continuation","End"].includes(t[":event-type"]),e=e.slice(l+u+4)}return{payload:r.records.join(""),body:n}},getSourceParams:function(e){var t=this.options.CopySourceParser;if(t)return t(e);e=e.match(/^([^.]+-\d+)\.cos(v6|-cdc|-cdz|-internal)?\.([^.]+)\.((myqcloud\.com)|(tencentcos\.cn))\/(.+)$/);return e?{Bucket:e[1],Region:e[3],Key:e[7]}:null},isBrowser:!0,isNode:function(){return"object"!==("undefined"==typeof window?"undefined":o(window))&&"object"===(void 0===e?"undefined":o(e))&&!("object"===("undefined"==typeof globalThis?"undefined":o(globalThis))&&("DedicatedWorkerGlobalScope"===globalThis.constructor.name||globalThis.FileReaderSync))},isCIHost:function(e){return/^https?:\/\/([^/]+\.)?ci\.[^/]+/.test(e)},isIOS_QQ:R&&E};x.exports=w}.call(this,A(3))},function(e,t,n){"use strict";function r(e,t){return(t=void 0===t?Object:t)&&"function"==typeof t.freeze?t.freeze(e):e}var o=r({HTML:"text/html",isHTML:function(e){return e===o.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),i=r({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(e){return e===i.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});t.assign=function(e,t){if(null===e||"object"!=typeof e)throw new TypeError("target is not an object");for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},t.find=function(e,t,n){if(void 0===n&&(n=Array.prototype),e&&"function"==typeof n.find)return n.find.call(e,t);for(var r=0;r<e.length;r++)if(Object.prototype.hasOwnProperty.call(e,r)){var o=e[r];if(t.call(void 0,o,r,e))return o}},t.freeze=r,t.MIME_TYPE=o,t.NAMESPACE=i},function(e,t){var n,r,e=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:i}catch(e){r=i}}();var s,c=[],u=!1,l=-1;function d(){u&&s&&(u=!1,s.length?c=s.concat(c):l=-1,c.length&&p())}function p(){if(!u){var e=a(d);u=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,u=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function f(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||u||a(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=f,e.addListener=f,e.once=f,e.off=f,e.removeListener=f,e.removeAllListeners=f,e.emit=f,e.prependListener=f,e.prependOnceListener=f,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){var r=n(2),a=r.find,k=r.NAMESPACE;function o(e){return""!==e}function i(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function c(e){if(!e)return[];e=e?e.split(/[\t\n\f\r ]+/).filter(o):[];return Object.keys(e.reduce(i,{}))}function s(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function u(e,t){var n=e.prototype;function r(){}n instanceof t||(r.prototype=t.prototype,s(n,r=new r),e.prototype=n=r),n.constructor!=e&&(n.constructor=e)}var n={},S=n.ELEMENT_NODE=1,b=n.ATTRIBUTE_NODE=2,T=n.TEXT_NODE=3,R=n.CDATA_SECTION_NODE=4,E=n.ENTITY_REFERENCE_NODE=5,w=(n.ENTITY_NODE=6,n.PROCESSING_INSTRUCTION_NODE=7),x=n.COMMENT_NODE=8,A=n.DOCUMENT_NODE=9,B=n.DOCUMENT_TYPE_NODE=10,O=n.DOCUMENT_FRAGMENT_NODE=11,r=(n.NOTATION_NODE=12,{}),l={},d=(r.INDEX_SIZE_ERR=(l[1]="Index size error",1),r.DOMSTRING_SIZE_ERR=(l[2]="DOMString size error",2),r.HIERARCHY_REQUEST_ERR=(l[3]="Hierarchy request error",3)),p=(r.WRONG_DOCUMENT_ERR=(l[4]="Wrong document",4),r.INVALID_CHARACTER_ERR=(l[5]="Invalid character",5),r.NO_DATA_ALLOWED_ERR=(l[6]="No data allowed",6),r.NO_MODIFICATION_ALLOWED_ERR=(l[7]="No modification allowed",7),r.NOT_FOUND_ERR=(l[8]="Not found",8));r.NOT_SUPPORTED_ERR=(l[9]="Not supported",9),r.INUSE_ATTRIBUTE_ERR=(l[10]="Attribute in use",10);function h(e,t){var n;return t instanceof Error?n=t:(n=this,Error.call(this,l[e]),this.message=l[e],Error.captureStackTrace&&Error.captureStackTrace(this,h)),n.code=e,t&&(this.message=this.message+": "+t),n}function f(){}function m(e,t){this._node=e,this._refresh=t,g(this)}function g(e){var t,n=e._node._inc||e._node.ownerDocument._inc;e._inc!=n&&(t=e._refresh(e._node),de(e,"length",t.length),s(t,e),e._inc=n)}function y(){}function v(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function C(e,t,n,r){var o;r?t[v(t,r)]=n:t[t.length++]=n,e&&(o=(n.ownerElement=e).ownerDocument)&&(r&&M(o,e,r),e=e,n=n,o&&o._inc++,n.namespaceURI===k.XMLNS&&(e._nsMap[n.prefix?n.localName:""]=n.value))}function I(e,t,n){var r=v(t,n);if(!(0<=r))throw new h(p,new Error(e.tagName+"@"+n));for(var o,i=t.length-1;r<i;)t[r]=t[++r];t.length=i,e&&(o=e.ownerDocument)&&(M(o,e,n),n.ownerElement=null)}function _(){}function D(){}function P(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function N(e,t){if(t(e))return 1;if(e=e.firstChild)do{if(N(e,t))return 1}while(e=e.nextSibling)}function U(){this.ownerDocument=this}function M(e,t,n){e&&e._inc++,n.namespaceURI===k.XMLNS&&delete t._nsMap[n.prefix?n.localName:""]}function L(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var o=t.firstChild,i=0;o;)o=(r[i++]=o).nextSibling;r.length=i,delete r[r.length]}}}function H(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,L(e.ownerDocument,e),t}function j(e){return e&&e.nodeType===D.DOCUMENT_TYPE_NODE}function F(e){return e&&e.nodeType===D.ELEMENT_NODE}function K(e){return e&&e.nodeType===D.TEXT_NODE}function q(e,t){var n=e.childNodes||[];if(!a(n,F)&&!j(t)){e=a(n,j);return!(t&&e&&n.indexOf(e)>n.indexOf(t))}}function z(e,t){var n=e.childNodes||[];if(!a(n,function(e){return F(e)&&e!==t})){e=a(n,j);return!(t&&e&&n.indexOf(e)>n.indexOf(t))}}function G(e,t,n){var r=e.childNodes||[],o=t.childNodes||[];if(t.nodeType===D.DOCUMENT_FRAGMENT_NODE){var i=o.filter(F);if(1<i.length||a(o,K))throw new h(d,"More than one element or text in fragment");if(1===i.length&&!q(e,n))throw new h(d,"Element in fragment can not be inserted before doctype")}if(F(t)&&!q(e,n))throw new h(d,"Only one element can be added and only after doctype");if(j(t)){if(a(r,j))throw new h(d,"Only one doctype is allowed");t=a(r,F);if(n&&r.indexOf(t)<r.indexOf(n))throw new h(d,"Doctype can only be inserted before an element");if(!n&&t)throw new h(d,"Doctype can not be appended since element is present")}}function V(e,t,n){var r=e.childNodes||[],o=t.childNodes||[];if(t.nodeType===D.DOCUMENT_FRAGMENT_NODE){var i=o.filter(F);if(1<i.length||a(o,K))throw new h(d,"More than one element or text in fragment");if(1===i.length&&!z(e,n))throw new h(d,"Element in fragment can not be inserted before doctype")}if(F(t)&&!z(e,n))throw new h(d,"Only one element can be added and only after doctype");if(j(t)){if(a(r,function(e){return j(e)&&e!==n}))throw new h(d,"Only one doctype is allowed");t=a(r,F);if(n&&r.indexOf(t)<r.indexOf(n))throw new h(d,"Doctype can only be inserted before an element")}}function X(e,t,n,r){(function(e,t,n){if(!e||e.nodeType!==D.DOCUMENT_NODE&&e.nodeType!==D.DOCUMENT_FRAGMENT_NODE&&e.nodeType!==D.ELEMENT_NODE)throw new h(d,"Unexpected parent node type "+e.nodeType);if(n&&n.parentNode!==e)throw new h(p,"child not in parent");if(!t||!(F(t)||K(t)||j(t)||t.nodeType===D.DOCUMENT_FRAGMENT_NODE||t.nodeType===D.COMMENT_NODE||t.nodeType===D.PROCESSING_INSTRUCTION_NODE)||j(t)&&e.nodeType!==D.DOCUMENT_NODE)throw new h(d,"Unexpected node type "+t.nodeType+" for parent node type "+e.nodeType)})(e,t,n),e.nodeType===D.DOCUMENT_NODE&&(r||G)(e,t,n);r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===O){var o=t.firstChild;if(null==o)return t;var i=t.lastChild}else o=i=t;r=n?n.previousSibling:e.lastChild;for(o.previousSibling=r,i.nextSibling=n,r?r.nextSibling=o:e.firstChild=o,null==n?e.lastChild=i:n.previousSibling=i;o.parentNode=e,o!==i&&(o=o.nextSibling););return L(e.ownerDocument||e,e),t.nodeType==O&&(t.firstChild=t.lastChild=null),t}function W(){this._nsMap={}}function Q(){}function J(){}function $(){}function Y(){}function Z(){}function ee(){}function te(){}function ne(){}function re(){}function oe(){}function ie(){}function ae(){}function se(e,t){var n,r=[],o=9==this.nodeType&&this.documentElement||this,i=o.prefix,a=o.namespaceURI;return le(this,r,e,t,n=a&&null==i&&null==(i=o.lookupPrefix(a))?[{namespace:a,prefix:null}]:n),r.join("")}function ce(e,t,n){var r=e.prefix||"",o=e.namespaceURI;if(o&&("xml"!==r||o!==k.XML)&&o!==k.XMLNS){for(var i=n.length;i--;){var a=n[i];if(a.prefix===r)return a.namespace!==o}return 1}}function ue(e,t,n){e.push(" ",t,'="',n.replace(/[<>&"\t\n\r]/g,P),'"')}function le(e,t,n,r,o){if(o=o||[],r){if(!(e=r(e)))return;if("string"==typeof e)return t.push(e),0}switch(e.nodeType){case S:var i=e.attributes,a=i.length,s=e.firstChild,c=e.tagName,u=c;if(!(n=k.isHTML(e.namespaceURI)||n)&&!e.prefix&&e.namespaceURI){for(var l,d,p=0;p<i.length;p++)if("xmlns"===i.item(p).name){l=i.item(p).value;break}if(!l)for(var h=o.length-1;0<=h;h--)if(""===(d=o[h]).prefix&&d.namespace===e.namespaceURI){l=d.namespace;break}if(l!==e.namespaceURI)for(h=o.length-1;0<=h;h--)if((d=o[h]).namespace===e.namespaceURI){d.prefix&&(u=d.prefix+":"+c);break}}t.push("<",u);for(var f,m,g,y=0;y<a;y++)"xmlns"==(f=i.item(y)).prefix?o.push({prefix:f.localName,namespace:f.value}):"xmlns"==f.nodeName&&o.push({prefix:"",namespace:f.value});for(y=0;y<a;y++)ce(f=i.item(y),0,o)&&(ue(t,(m=f.prefix||"")?"xmlns:"+m:"xmlns",g=f.namespaceURI),o.push({prefix:m,namespace:g})),le(f,t,n,r,o);if(c===u&&ce(e,0,o)&&(ue(t,(m=e.prefix||"")?"xmlns:"+m:"xmlns",g=e.namespaceURI),o.push({prefix:m,namespace:g})),s||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),n&&/^script$/i.test(c))for(;s;)s.data?t.push(s.data):le(s,t,n,r,o.slice()),s=s.nextSibling;else for(;s;)le(s,t,n,r,o.slice()),s=s.nextSibling;t.push("</",u,">")}else t.push("/>");return;case A:case O:for(s=e.firstChild;s;)le(s,t,n,r,o.slice()),s=s.nextSibling;return;case b:return ue(t,e.name,e.value),0;case T:return t.push(e.data.replace(/[<&>]/g,P));case R:return t.push("<![CDATA[",e.data,"]]>");case x:return t.push("\x3c!--",e.data,"--\x3e");case B:var v=e.publicId,C=e.systemId;return t.push("<!DOCTYPE ",e.name),void(v?(t.push(" PUBLIC ",v),C&&"."!=C&&t.push(" ",C),t.push(">")):C&&"."!=C?t.push(" SYSTEM ",C,">"):((C=e.internalSubset)&&t.push(" [",C,"]"),t.push(">")));case w:return t.push("<?",e.target," ",e.data,"?>");case E:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function de(e,t,n){e[t]=n}r.INVALID_STATE_ERR=(l[11]="Invalid state",11),r.SYNTAX_ERR=(l[12]="Syntax error",12),r.INVALID_MODIFICATION_ERR=(l[13]="Invalid modification",13),r.NAMESPACE_ERR=(l[14]="Invalid namespace",14),r.INVALID_ACCESS_ERR=(l[15]="Invalid access",15),h.prototype=Error.prototype,s(r,h),f.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)le(this[r],n,e,t);return n.join("")},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}},m.prototype.item=function(e){return g(this),this[e]},u(m,f),y.prototype={length:0,item:f.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new h(10);t=this.getNamedItem(e.nodeName);return C(this._ownerElement,this,e,t),t},setNamedItemNS:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new h(10);return t=this.getNamedItemNS(e.namespaceURI,e.localName),C(this._ownerElement,this,e,t),t},removeNamedItem:function(e){e=this.getNamedItem(e);return I(this._ownerElement,this,e),e},removeNamedItemNS:function(e,t){t=this.getNamedItemNS(e,t);return I(this._ownerElement,this,t),t},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},_.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var r=new U;return r.implementation=this,r.childNodes=new f,r.doctype=n||null,n&&r.appendChild(n),t&&(t=r.createElementNS(e,t),r.appendChild(t)),r},createDocumentType:function(e,t,n){var r=new ee;return r.name=e,r.nodeName=e,r.publicId=t||"",r.systemId=n||"",r}},D.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return X(this,e,t)},replaceChild:function(e,t){X(this,e,t,V),t&&this.removeChild(t)},removeChild:function(e){return H(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var o,i,a=new n.constructor;for(o in n)!Object.prototype.hasOwnProperty.call(n,o)||"object"!=typeof(i=n[o])&&i!=a[o]&&(a[o]=i);switch(n.childNodes&&(a.childNodes=new f),a.ownerDocument=t,a.nodeType){case S:var s=n.attributes,c=a.attributes=new y,u=s.length;c._ownerElement=a;for(var l=0;l<u;l++)a.setAttributeNode(e(t,s.item(l),!0));break;case b:r=!0}if(r)for(var d=n.firstChild;d;)a.appendChild(e(t,d,r)),d=d.nextSibling;return a}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==T&&e.nodeType==T?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return 0<this.attributes.length},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===e)return r;t=t.nodeType==b?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==b?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},s(n,D),s(n,D.prototype),U.prototype={nodeName:"#document",nodeType:A,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType!=O)return X(this,e,t),null===(e.ownerDocument=this).documentElement&&e.nodeType===S&&(this.documentElement=e),e;for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),H(this,e)},replaceChild:function(e,t){X(this,e,t,V),e.ownerDocument=this,t&&this.removeChild(t),F(e)&&(this.documentElement=e)},importNode:function(e,t){return function e(t,n,r){var o;switch(n.nodeType){case S:(o=n.cloneNode(!1)).ownerDocument=t;case O:break;case b:r=!0}if((o=o||n.cloneNode(!1)).ownerDocument=t,o.parentNode=null,r)for(var i=n.firstChild;i;)o.appendChild(e(t,i,r)),i=i.nextSibling;return o}(this,e,t)},getElementById:function(t){var n=null;return N(this.documentElement,function(e){if(e.nodeType==S&&e.getAttribute("id")==t)return n=e,!0}),n},getElementsByClassName:function(a){var s=c(a);return new m(this,function(o){var i=[];return 0<s.length&&N(o.documentElement,function(e){var t,n,r;e===o||e.nodeType!==S||(t=e.getAttribute("class"))&&((n=a===t)||(t=c(t),n=s.every((r=t,function(e){return r&&-1!==r.indexOf(e)}))),n&&i.push(e))}),i})},createElement:function(e){var t=new W;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new f,(t.attributes=new y)._ownerElement=t},createDocumentFragment:function(){var e=new oe;return e.ownerDocument=this,e.childNodes=new f,e},createTextNode:function(e){var t=new $;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Y;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new Z;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ie;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new Q;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new re;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new W,r=t.split(":"),o=n.attributes=new y;return n.childNodes=new f,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,o._ownerElement=n},createAttributeNS:function(e,t){var n=new Q,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},u(U,D),U.prototype.getElementsByTagName=(W.prototype={nodeType:S,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){e=this.getAttributeNode(e);return e&&e.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){e=this.ownerDocument.createAttribute(e);e.value=e.nodeValue=""+t,this.setAttributeNode(e)},removeAttribute:function(e){e=this.getAttributeNode(e);e&&this.removeAttributeNode(e)},appendChild:function(e){return e.nodeType===O?this.insertBefore(e,null):(t=this,(e=e).parentNode&&e.parentNode.removeChild(e),e.parentNode=t,e.previousSibling=t.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,t.lastChild=e,L(t.ownerDocument,t,e),e);var t},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){t=this.getAttributeNodeNS(e,t);t&&this.removeAttributeNode(t)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){t=this.getAttributeNodeNS(e,t);return t&&t.value||""},setAttributeNS:function(e,t,n){t=this.ownerDocument.createAttributeNS(e,t);t.value=t.nodeValue=""+n,this.setAttributeNode(t)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(r){return new m(this,function(t){var n=[];return N(t,function(e){e===t||e.nodeType!=S||"*"!==r&&e.tagName!=r||n.push(e)}),n})},getElementsByTagNameNS:function(r,o){return new m(this,function(t){var n=[];return N(t,function(e){e===t||e.nodeType!==S||"*"!==r&&e.namespaceURI!==r||"*"!==o&&e.localName!=o||n.push(e)}),n})}}).getElementsByTagName,U.prototype.getElementsByTagNameNS=W.prototype.getElementsByTagNameNS,u(W,D),Q.prototype.nodeType=b,u(Q,D),J.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(l[d])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},u(J,D),$.prototype={nodeName:"#text",nodeType:T,splitText:function(e){var t=(n=this.data).substring(e),n=n.substring(0,e);this.data=this.nodeValue=n,this.length=n.length;t=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling),t}},u($,J),Y.prototype={nodeName:"#comment",nodeType:x},u(Y,J),Z.prototype={nodeName:"#cdata-section",nodeType:R},u(Z,J),ee.prototype.nodeType=B,u(ee,D),te.prototype.nodeType=12,u(te,D),ne.prototype.nodeType=6,u(ne,D),re.prototype.nodeType=E,u(re,D),oe.prototype.nodeName="#document-fragment",oe.prototype.nodeType=O,u(oe,D),ie.prototype.nodeType=w,u(ie,D),ae.prototype.serializeToString=function(e,t,n){return se.call(e,t,n)},D.prototype.toString=se;try{Object.defineProperty&&(Object.defineProperty(m.prototype,"length",{get:function(){return g(this),this.$$length}}),Object.defineProperty(D.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case S:case O:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case S:case O:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),de=function(e,t,n){e["$$"+t]=n})}catch(e){}t.DocumentType=ee,t.DOMException=h,t.DOMImplementation=_,t.Element=W,t.Node=D,t.NodeList=f,t.XMLSerializer=ae},function(e,t,n){var h=n(22),r=n(23),d=n(0),f=n(7),o=null,m=function(e){var t;return o||(t=n(24),o=new t({appkey:"0AND0VEVB24UBGDU",versionCode:f.version,channelID:"js_sdk",openid:"openid",unionid:"unid",strictMode:!1,delay:e,sessionDuration:6e4})),o},g=function(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},i=function(){return!("object"!==("undefined"==typeof navigator?"undefined":d(navigator))||!navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i))},i={isMobile:i(),isBrowser:!i(),mobileOsType:"object"===("undefined"==typeof navigator?"undefined":d(navigator))&&navigator.userAgent.match(/(Android|Adr|Linux)/i)?"android":"ios",pcOsType:function(){if("object"!==("undefined"==typeof navigator?"undefined":d(navigator)))return"unknown os";var e=navigator.userAgent.toLowerCase(),t=/macintosh|mac os x/i.test(navigator.userAgent);return 0<=e.indexOf("win32")||0<=e.indexOf("wow32")?"win32":0<=e.indexOf("win64")||0<=e.indexOf("wow64")?"win64":t?"mac":"unknown os"}()},y={deviceType:i.isMobile?"mobile":i.isBrowser?"browser":"unknown",devicePlatform:i.isMobile?i.mobileOsType:i.pcOsType,deviceName:function(){if("object"!==("undefined"==typeof navigator?"undefined":d(navigator)))return"unknown device";var e=navigator.userAgent.toLowerCase();if(e.includes("app/tencent_wemeet"))return"tencent_wemeet";if(0<=e.indexOf("maxthon")){var t=e.match(/maxthon\/([\d.]+)/),t=t&&t[1]||"";return"傲游浏览器 ".concat(t).trim()}if(0<=e.indexOf("qqbrowser")){t=e.match(/qqbrowser\/([\d.]+)/),t=t&&t[1]||"";return"QQ浏览器 ".concat(t).trim()}if(0<=e.indexOf("se 2.x"))return"搜狗浏览器";if(0<=e.indexOf("wxwork"))return"微信内置浏览器";if(0<=e.indexOf("msie")){var n=e.match(/msie ([\d.]+)/),n=n&&n[1]||"";return"IE ".concat(n).trim()}if(0<=e.indexOf("firefox")){n=e.match(/firefox\/([\d.]+)/),n=n&&n[1]||"";return"Firefox ".concat(n).trim()}if(0<=e.indexOf("chrome")){var r=e.match(/chrome\/([\d.]+)/),r=r&&r[1]||"";return"Chrome ".concat(r).trim()}if(0<=e.indexOf("opera")){r=e.match(/opera.([\d.]+)/),r=r&&r[1]||"";return"Opera ".concat(r).trim()}if(0<=e.indexOf("safari")){var o=e.match(/version\/([\d.]+)/),o=o&&o[1]||"";return"Safari ".concat(o).trim()}if(0<=e.indexOf("edge")){o=e.match(/edge\/([\d.]+)/),o=o&&o[1]||"";return"edge ".concat(o).trim()}return e.substr(0,200)}()},a=["multipartInit","multipartUpload","multipartComplete","multipartList","multipartListPart","multipartAbort"],s=["putObject","postObject","appendObject","sliceUploadFile","uploadFile","uploadFiles"].concat(a),c=["getObject"];i=function(){"use strict";function p(e){h(this,p);var t=e.parent,n=e.traceId,r=e.bucket,o=e.region,i=e.apiName,a=e.fileKey,s=e.fileSize,c=e.accelerate,u=e.customId,l=e.delay,d=e.deepTracker,e=r&&r.substr(r.lastIndexOf("-")+1)||"";this.parent=t,this.deepTracker=d,this.delay=l,this.params={cossdkVersion:f.version,region:o,networkType:"",host:"",accelerate:c?"Y":"N",requestPath:a||"",size:s||-1,httpMd5:0,httpSign:0,httpFull:0,name:i||"",result:"",tookTime:0,errorNode:"",errorCode:"",errorMessage:"",errorRequestId:"",errorStatusCode:0,errorServiceName:"",tracePlatform:"cos-js-sdk-v5",traceId:n||g(),bucket:r,appid:e,partNumber:0,retryTimes:0,reqUrl:"",customId:u||"",deviceType:y.deviceType,devicePlatform:y.devicePlatform,deviceName:y.deviceName,md5StartTime:0,md5EndTime:0,signStartTime:0,signEndTime:0,httpStartTime:0,httpEndTime:0,startTime:(new Date).getTime(),endTime:0},this.beacon=m(l)}return r(p,[{key:"formatResult",value:function(e,t){var n,r=(new Date).getTime()-this.params.startTime,o=function(){if("object"!==("undefined"==typeof navigator?"undefined":d(navigator)))return"unknown";var e=navigator.connection||navigator.mozConnection||navigator.webkitConnection;return(null==e?void 0:e.type)||(null==e?void 0:e.effectiveType)||"unknown"}(),i=e?(null==e?void 0:e.code)||(null==e||null===(n=e.error)||void 0===n?void 0:n.code)||(null==e||null===(i=e.error)||void 0===i?void 0:i.Code):"",a=e?(null==e?void 0:e.message)||(null==e||null===(a=e.error)||void 0===a?void 0:a.message)||(null==e||null===(s=e.error)||void 0===s?void 0:s.Message):"",s=e?(null==e?void 0:e.resource)||(null==e||null===(c=e.error)||void 0===c?void 0:c.resource)||(null==e||null===(u=e.error)||void 0===u?void 0:u.Resource):"",c=e?null==e?void 0:e.statusCode:t.statusCode,u=e?(null==e?void 0:e.headers)&&(null==e?void 0:e.headers["x-cos-request-id"]):(null==t?void 0:t.headers)&&(null==t?void 0:t.headers["x-cos-request-id"]);if(Object.assign(this.params,{tookTime:r,networkType:o,httpMd5:this.params.md5EndTime-this.params.md5StartTime,httpSign:this.params.signEndTime-this.params.signStartTime,httpFull:this.params.httpEndTime-this.params.httpStartTime,result:e?"Fail":"Success",errorType:e?u?"Server":"Client":"",errorCode:i,errorStatusCode:c,errorMessage:a,errorServiceName:s,errorRequestId:u}),!e||i&&a||(this.params.fullError=e?JSON.stringify(e):""),"getObject"===this.params.name&&(this.params.size=t?t.headers&&t.headers["content-length"]:-1),this.params.reqUrl)try{var l=/^http(s)?:\/\/(.*?)\//.exec(this.params.reqUrl);this.params.host=l[2]}catch(e){this.params.host=this.params.reqUrl}this.sendEvents()}},{key:"setParams",value:function(e){Object.assign(this.params,e)}},{key:"sendEvents",value:function(){var e,t;a.includes(this.params.name)&&!this.deepTracker||(t=this.params.name,e=s.includes(t)?"cos_upload":c.includes(t)?"cos_download":"base_service",t=function(e){var t,n={},r="Success"===e.result?["tracePlatform","cossdkVersion","region","bucket","appid","networkType","host","accelerate","requestPath","partNumber","size","name","result","tookTime","errorRequestId","retryTimes","reqUrl","customId","deviceType","devicePlatform","deviceName"]:["tracePlatform","cossdkVersion","region","networkType","host","accelerate","requestPath","size","httpMd5","httpSign","httpFull","name","result","tookTime","errorNode","errorCode","errorMessage","errorRequestId","errorStatusCode","errorServiceName","errorType","traceId","bucket","appid","partNumber","retryTimes","reqUrl","customId","fullError","deviceType","devicePlatform","deviceName"];for(t in e)r.includes(t)&&(n[t.replace(/([A-Z])/g,"_$1").toLowerCase()]=e[t]);return n}(this.params),this.beacon||(this.beacon=m(this.delay||5e3)),0===this.delay?this.beacon&&this.beacon.onDirectUserAction(e,t):this.beacon&&this.beacon.onUserAction(e,t))}},{key:"generateSubTracker",value:function(e){return Object.assign(e,{parent:this,deepTracker:this.deepTracker,traceId:this.params.traceId,bucket:this.params.bucket,region:this.params.region,fileKey:this.params.requestPath,customId:this.params.customId,delay:this.delay}),new p(e)}}]),p}();e.exports=i},function(e){e.exports=JSON.parse('{"name":"cos-js-sdk-v5","version":"1.4.16","description":"JavaScript SDK for [腾讯云对象存储](https://cloud.tencent.com/product/cos)","main":"dist/cos-js-sdk-v5.js","types":"index.d.ts","scripts":{"server":"node server/sts.js","dev":"cross-env NODE_ENV=development webpack -w --mode=development","build":"cross-env NODE_ENV=production webpack --mode=production","cos-auth.min.js":"uglifyjs ./demo/common/cos-auth.js -o ./demo/common/cos-auth.min.js -c -m","test":"jest --coverage"},"repository":{"type":"git","url":"git+https://github.com/tencentyun/cos-js-sdk-v5.git"},"keywords":[],"author":"carsonxu","license":"ISC","bugs":{"url":"https://github.com/tencentyun/cos-js-sdk-v5/issues"},"homepage":"https://github.com/tencentyun/cos-js-sdk-v5#readme","dependencies":{"@xmldom/xmldom":"^0.8.6"},"devDependencies":{"@babel/core":"7.17.9","@babel/plugin-transform-runtime":"7.18.10","@babel/preset-env":"7.16.11","babel-loader":"8.2.5","body-parser":"^1.18.3","cross-env":"^5.2.0","express":"^4.16.4","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","qcloud-cos-sts":"^3.0.2","request":"^2.87.0","terser-webpack-plugin":"4.2.3","uglifyjs":"^2.4.11","webpack":"4.46.0","webpack-cli":"4.10.0"}}')},function(e,t){function n(e){function o(e){return t[e]||(t[e]=[]),t[e]}var t={};e.on=function(e,t){o(e).push(t)},e.off=function(e,t){for(var n=o(e),r=n.length-1;0<=r;r--)t===n[r]&&n.splice(r,1)},e.emit=function(e,t){for(var n=o(e).map(function(e){return e}),r=0;r<n.length;r++)n[r](t)}}e.exports.init=n,e.exports.EventProxy=function(){n(this)}},function(e,t,n){function o(){try{s.length?localStorage.setItem(u,JSON.stringify(s)):localStorage.removeItem(u)}catch(e){}}function i(){if(!s){!function(){try{var e=JSON.parse(localStorage.getItem(u))}catch(e){}s=e=e||[]}.call(this);for(var e=!1,t=Math.round(Date.now()/1e3),n=s.length-1;0<=n;n--){var r=s[n][2];(!r||r+2592e3<t)&&(s.splice(n,1),e=!0)}e&&o()}}function a(){r=r||setTimeout(function(){o(),r=null},400)}var s,r,c=n(1),u="cos_sdk_upload_cache",l={using:{},setUsing:function(e){l.using[e]=!0},removeUsing:function(e){delete l.using[e]},getFileId:function(e,t,n,r){return e.name&&e.size&&e.lastModifiedDate&&t?c.md5([e.name,e.size,e.lastModifiedDate,t,n,r].join("::")):null},getCopyFileId:function(e,t,n,r,o){var i=t["content-length"],a=t.etag||"",t=t["last-modified"];return e&&n?c.md5([e,i,a,t,n,r,o].join("::")):null},getUploadIdList:function(e){if(!e)return null;i.call(this);for(var t=[],n=0;n<s.length;n++)s[n][0]===e&&t.push(s[n][1]);return t.length?t:null},saveUploadId:function(e,t,n){if(i.call(this),e){for(var r=s.length-1;0<=r;r--){var o=s[r];o[0]===e&&o[1]===t&&s.splice(r,1)}s.unshift([e,t,Math.round(Date.now()/1e3)]),s.length>n&&s.splice(n),a()}},removeUploadId:function(e){i.call(this),delete l.using[e];for(var t=s.length-1;0<=t;t--)s[t][1]===e&&s.splice(t,1);a()}};e.exports=l},function(e,t,n){n=n(11);e.exports=n},function(e,t,n){"use strict";var r=n(1),o=n(8),i=n(25),a=n(26),s=n(28),c=n(7),u={AppId:"",SecretId:"",SecretKey:"",SecurityToken:"",ChunkRetryTimes:2,FileParallelLimit:3,ChunkParallelLimit:3,ChunkSize:1048576,SliceSize:1048576,CopyChunkParallelLimit:20,CopyChunkSize:10485760,CopySliceSize:10485760,MaxPartNumber:1e4,ProgressInterval:1e3,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadQueueSize:1e4,UploadAddMetaMd5:!1,UploadIdCacheLimit:50,UseAccelerate:!1,ForceSignHost:!0,EnableTracker:!1,DeepTracker:!1,TrackerDelay:5e3,CustomId:""},n=function(e){this.options=r.extend(r.clone(u),e||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1048576,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1048576,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.AppId,this.options.SecretId&&this.options.SecretId.indexOf(" "),this.options.SecretKey&&this.options.SecretKey.indexOf(" "),r.isNode(),o.init(this),i.init(this)};a.init(n,i),s.init(n,i),n.util={md5:r.md5,xml2json:r.xml2json,json2xml:r.json2xml},n.getAuthorization=r.getAuth,n.version=c.version,e.exports=n},function(module,exports,__webpack_require__){!function(process,global,module){var __WEBPACK_AMD_DEFINE_RESULT__,_typeof=__webpack_require__(0);!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"===("undefined"==typeof window?"undefined":_typeof(window)),root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"===("undefined"==typeof self?"undefined":_typeof(self)),NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"===(void 0===process?"undefined":_typeof(process))&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"===_typeof(module)&&module.exports,AMD=__webpack_require__(14),ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8,buffer,buffer8,blocks;ARRAY_BUFFER&&(buffer=new ArrayBuffer(68),buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)),!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"===_typeof(e)&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(n){return function(e,t){return new Md5(!0).update(e,t)[n]()}},createMethod=function(){var t=createOutputMethod("hex");(t=NODE_JS?nodeWrap(t):t).getCtx=t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var n=OUTPUT_TYPES[e];t[n]=createOutputMethod(n)}return t},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null==e)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8):ARRAY_BUFFER?(e=new ArrayBuffer(68),this.buffer8=new Uint8Array(e),this.blocks=new Uint32Array(e)):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e,t){if(!this.finalized){for(var n,r,o=0,i=e.length,a=this.blocks,s=this.buffer8;o<i;){if(this.hashed&&(this.hashed=!1,a[0]=a[16],a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),ARRAY_BUFFER)for(r=this.start;o<i&&r<64;++o)n=e.charCodeAt(o),t||n<128?s[r++]=n:(n<2048?s[r++]=192|n>>6:(n<55296||57344<=n?s[r++]=224|n>>12:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++o)),s[r++]=240|n>>18,s[r++]=128|n>>12&63),s[r++]=128|n>>6&63),s[r++]=128|63&n);else for(r=this.start;o<i&&r<64;++o)n=e.charCodeAt(o),t||n<128?a[r>>2]|=n<<SHIFT[3&r++]:(n<2048?a[r>>2]|=(192|n>>6)<<SHIFT[3&r++]:(n<55296||57344<=n?a[r>>2]|=(224|n>>12)<<SHIFT[3&r++]:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++o)),a[r>>2]|=(240|n>>18)<<SHIFT[3&r++],a[r>>2]|=(128|n>>12&63)<<SHIFT[3&r++]),a[r>>2]|=(128|n>>6&63)<<SHIFT[3&r++]),a[r>>2]|=(128|63&n)<<SHIFT[3&r++]);this.lastByteIndex=r,this.bytes+=r-this.start,64<=r?(this.start=r-64,this.hash(),this.hashed=!0):this.start=r}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){var e,t;this.finalized||(this.finalized=!0,(e=this.blocks)[(t=this.lastByteIndex)>>2]|=EXTRA[3&t],56<=t&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash())},Md5.prototype.hash=function(){var e,t,n,r,o,i=this.blocks,a=this.first?((a=((e=((e=i[0]-680876937)<<7|e>>>25)-271733879<<0)^(t=((t=(-271733879^(n=((n=(-1732584194^2004318071&e)+i[1]-117830708)<<12|n>>>20)+e<<0)&(-271733879^e))+i[2]-1126478375)<<17|t>>>15)+n<<0)&(n^e))+i[3]-1316259209)<<22|a>>>10)+t<<0:(e=this.h0,a=this.h1,t=this.h2,((a+=((e=((e+=((n=this.h3)^a&(t^n))+i[0]-680876936)<<7|e>>>25)+a<<0)^(t=((t+=(a^(n=((n+=(t^e&(a^t))+i[1]-389564586)<<12|n>>>20)+e<<0)&(e^a))+i[2]+606105819)<<17|t>>>15)+n<<0)&(n^e))+i[3]-1044525330)<<22|a>>>10)+t<<0);a=((a+=((e=((e+=(n^a&(t^n))+i[4]-176418897)<<7|e>>>25)+a<<0)^(t=((t+=(a^(n=((n+=(t^e&(a^t))+i[5]+1200080426)<<12|n>>>20)+e<<0)&(e^a))+i[6]-1473231341)<<17|t>>>15)+n<<0)&(n^e))+i[7]-45705983)<<22|a>>>10)+t<<0,a=((a+=((e=((e+=(n^a&(t^n))+i[8]+1770035416)<<7|e>>>25)+a<<0)^(t=((t+=(a^(n=((n+=(t^e&(a^t))+i[9]-1958414417)<<12|n>>>20)+e<<0)&(e^a))+i[10]-42063)<<17|t>>>15)+n<<0)&(n^e))+i[11]-1990404162)<<22|a>>>10)+t<<0,a=((a+=((e=((e+=(n^a&(t^n))+i[12]+1804603682)<<7|e>>>25)+a<<0)^(t=((t+=(a^(n=((n+=(t^e&(a^t))+i[13]-40341101)<<12|n>>>20)+e<<0)&(e^a))+i[14]-1502002290)<<17|t>>>15)+n<<0)&(n^e))+i[15]+1236535329)<<22|a>>>10)+t<<0,a=((a+=((n=((n+=(a^t&((e=((e+=(t^n&(a^t))+i[1]-165796510)<<5|e>>>27)+a<<0)^a))+i[6]-1069501632)<<9|n>>>23)+e<<0)^e&((t=((t+=(e^a&(n^e))+i[11]+643717713)<<14|t>>>18)+n<<0)^n))+i[0]-373897302)<<20|a>>>12)+t<<0,a=((a+=((n=((n+=(a^t&((e=((e+=(t^n&(a^t))+i[5]-701558691)<<5|e>>>27)+a<<0)^a))+i[10]+38016083)<<9|n>>>23)+e<<0)^e&((t=((t+=(e^a&(n^e))+i[15]-660478335)<<14|t>>>18)+n<<0)^n))+i[4]-405537848)<<20|a>>>12)+t<<0,a=((a+=((n=((n+=(a^t&((e=((e+=(t^n&(a^t))+i[9]+568446438)<<5|e>>>27)+a<<0)^a))+i[14]-1019803690)<<9|n>>>23)+e<<0)^e&((t=((t+=(e^a&(n^e))+i[3]-187363961)<<14|t>>>18)+n<<0)^n))+i[8]+1163531501)<<20|a>>>12)+t<<0,a=((a+=((n=((n+=(a^t&((e=((e+=(t^n&(a^t))+i[13]-1444681467)<<5|e>>>27)+a<<0)^a))+i[2]-51403784)<<9|n>>>23)+e<<0)^e&((t=((t+=(e^a&(n^e))+i[7]+1735328473)<<14|t>>>18)+n<<0)^n))+i[12]-1926607734)<<20|a>>>12)+t<<0,a=((a+=((o=(n=((n+=((r=a^t)^(e=((e+=(r^n)+i[5]-378558)<<4|e>>>28)+a<<0))+i[8]-2022574463)<<11|n>>>21)+e<<0)^e)^(t=((t+=(o^a)+i[11]+1839030562)<<16|t>>>16)+n<<0))+i[14]-35309556)<<23|a>>>9)+t<<0,a=((a+=((o=(n=((n+=((r=a^t)^(e=((e+=(r^n)+i[1]-1530992060)<<4|e>>>28)+a<<0))+i[4]+1272893353)<<11|n>>>21)+e<<0)^e)^(t=((t+=(o^a)+i[7]-155497632)<<16|t>>>16)+n<<0))+i[10]-1094730640)<<23|a>>>9)+t<<0,a=((a+=((o=(n=((n+=((r=a^t)^(e=((e+=(r^n)+i[13]+681279174)<<4|e>>>28)+a<<0))+i[0]-358537222)<<11|n>>>21)+e<<0)^e)^(t=((t+=(o^a)+i[3]-722521979)<<16|t>>>16)+n<<0))+i[6]+76029189)<<23|a>>>9)+t<<0,a=((a+=((o=(n=((n+=((r=a^t)^(e=((e+=(r^n)+i[9]-640364487)<<4|e>>>28)+a<<0))+i[12]-421815835)<<11|n>>>21)+e<<0)^e)^(t=((t+=(o^a)+i[15]+530742520)<<16|t>>>16)+n<<0))+i[2]-995338651)<<23|a>>>9)+t<<0,a=((a+=((n=((n+=(a^((e=((e+=(t^(a|~n))+i[0]-198630844)<<6|e>>>26)+a<<0)|~t))+i[7]+1126891415)<<10|n>>>22)+e<<0)^((t=((t+=(e^(n|~a))+i[14]-1416354905)<<15|t>>>17)+n<<0)|~e))+i[5]-57434055)<<21|a>>>11)+t<<0,a=((a+=((n=((n+=(a^((e=((e+=(t^(a|~n))+i[12]+1700485571)<<6|e>>>26)+a<<0)|~t))+i[3]-1894986606)<<10|n>>>22)+e<<0)^((t=((t+=(e^(n|~a))+i[10]-1051523)<<15|t>>>17)+n<<0)|~e))+i[1]-2054922799)<<21|a>>>11)+t<<0,a=((a+=((n=((n+=(a^((e=((e+=(t^(a|~n))+i[8]+1873313359)<<6|e>>>26)+a<<0)|~t))+i[15]-30611744)<<10|n>>>22)+e<<0)^((t=((t+=(e^(n|~a))+i[6]-1560198380)<<15|t>>>17)+n<<0)|~e))+i[13]+1309151649)<<21|a>>>11)+t<<0,a=((a+=((n=((n+=(a^((e=((e+=(t^(a|~n))+i[4]-145523070)<<6|e>>>26)+a<<0)|~t))+i[11]-1120210379)<<10|n>>>22)+e<<0)^((t=((t+=(e^(n|~a))+i[2]+718787259)<<15|t>>>17)+n<<0)|~e))+i[9]-343485551)<<21|a>>>11)+t<<0,this.first?(this.h0=e+1732584193<<0,this.h1=a-271733879<<0,this.h2=t-1732584194<<0,this.h3=n+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+a<<0,this.h2=this.h2+t<<0,this.h3=this.h3+n<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(e){if("hex"===e)return this.hex();this.finalize();var t=this.h0,n=this.h1,r=this.h2,e=this.h3;return[255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255,255&r,r>>8&255,r>>16&255,r>>24&255,255&e,e>>8&255,e>>16&255,e>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,n,r="",o=this.array(),i=0;i<15;)e=o[i++],t=o[i++],n=o[i++],r+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|n>>>6)]+BASE64_ENCODE_CHAR[63&n];return e=o[i],r+(BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"==")};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}.call(this,__webpack_require__(3),__webpack_require__(13),__webpack_require__(4)(module))},function(e,t){var n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(t,e){!function(e){t.exports=e}.call(this,{})},function(e,t,c){!function(e){var t,u,s,n=c(0),r=function(s){function n(){}var e={},t=e.lib={},r=t.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),(t.init.prototype=t).$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=t.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||i).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;if(e=e.sigBytes,this.clamp(),r%4)for(var o=0;o<e;o++)t[r+o>>>2]|=(n[o>>>2]>>>24-o%4*8&255)<<24-(r+o)%4*8;else if(65535<n.length)for(o=0;o<e;o+=4)t[r+o>>>2]=n[o>>>2];else t.push.apply(t,n);return this.sigBytes+=e,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=s.ceil(t/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(4294967296*s.random()|0);return new c.init(t,e)}}),o=e.enc={},i=o.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var o=t[r>>>2]>>>24-r%4*8&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new c.init(n,t/2)}},a=o.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new c.init(n,t)}},u=o.Utf8={stringify:function(e){try{return decodeURIComponent(escape(a.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return a.parse(unescape(encodeURIComponent(e)))}},l=t.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,r=t.sigBytes,o=this.blockSize,i=r/(4*o);if(e=(i=e?s.ceil(i):s.max((0|i)-this._minBufferSize,0))*o,r=s.min(4*e,r),e){for(var a=0;a<e;a+=o)this._doProcessBlock(n,a);a=n.splice(0,e),t.sigBytes-=r}return new c.init(a,r)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});t.Hasher=l.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(e,t){return new n.init(t).finalize(e)}},_createHmacHelper:function(n){return function(e,t){return new d.HMAC.init(n,t).finalize(e)}}});var d=e.algo={};return e}(Math),o=(a=(t=r).lib).WordArray,i=a.Hasher,l=[],a=t.algo.SHA1=i.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n,r=this._hash.words,o=r[0],i=r[1],a=r[2],s=r[3],c=r[4],u=0;u<80;u++)u<16?l[u]=0|e[t+u]:(n=l[u-3]^l[u-8]^l[u-14]^l[u-16],l[u]=n<<1|n>>>31),n=(o<<5|o>>>27)+c+l[u],n=u<20?n+(1518500249+(i&a|~i&s)):u<40?n+(1859775393+(i^a^s)):u<60?n+((i&a|i&s|a&s)-1894007588):n+((i^a^s)-899497514),c=s,s=a,a=i<<30|i>>>2,i=o,o=n;r[0]=r[0]+o|0,r[1]=r[1]+i|0,r[2]=r[2]+a|0,r[3]=r[3]+s|0,r[4]=r[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return t[r>>>5]|=128<<24-r%32,t[14+(64+r>>>9<<4)]=Math.floor(n/4294967296),t[15+(64+r>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=i._createHelper(a),t.HmacSHA1=i._createHmacHelper(a),s=r.enc.Utf8,r.algo.HMAC=r.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var n=e.blockSize,r=4*n;(t=t.sigBytes>r?e.finalize(t):t).clamp();for(var e=this._oKey=t.clone(),t=this._iKey=t.clone(),o=e.words,i=t.words,a=0;a<n;a++)o[a]^=1549556828,i[a]^=909522486;e.sigBytes=t.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),u=r.lib.WordArray,r.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var a=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)o.push(r.charAt(a>>>6*(3-s)&63));var c=r.charAt(64);if(c)for(;o.length%4;)o.push(c);return o.join("")},parse:function(e){var t=e.length,n=this._map,r=n.charAt(64);!r||-1!=(r=e.indexOf(r))&&(t=r);for(var o,i,a=[],s=0,c=0;c<t;c++)c%4&&(o=n.indexOf(e.charAt(c-1))<<c%4*2,i=n.indexOf(e.charAt(c))>>>6-c%4*2,a[s>>>2]|=(o|i)<<24-s%4*8,s++);return u.create(a,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},"object"===n(e)?e.exports=r:window.CryptoJS=r}.call(this,c(4)(e))},function(e,t,n){var r=n(17).DOMParser,d=function(){this.version="1.3.5";var u={mergeCDATA:!0,normalize:!0,stripElemPrefix:!0},l=new RegExp(/(?!xmlns)^.*:/);return new RegExp(/^\s+|\s+$/g),this.grokType=function(e){return/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):e},this.parseString=function(e,t){if(e){e=this.stringToXML(e);return e.getElementsByTagName("parsererror").length?null:this.parseXML(e,t)}return null},this.parseXML=function(e,t){for(var n in t)u[n]=t[n];var r={},o=0,i="";if(e.childNodes.length)for(var a,s,c=0;c<e.childNodes.length;c++)4===(s=e.childNodes.item(c)).nodeType?u.mergeCDATA&&(i+=s.nodeValue):3===s.nodeType?i+=s.nodeValue:1===s.nodeType&&(0===o&&(r={}),a=u.stripElemPrefix?s.nodeName.replace(l,""):s.nodeName,s=d.parseXML(s),r.hasOwnProperty(a)?(r[a].constructor!==Array&&(r[a]=[r[a]]),r[a].push(s)):(r[a]=s,o++));return r=!Object.keys(r).length?i||"":r},this.xmlToString=function(e){try{return e.xml||(new XMLSerializer).serializeToString(e)}catch(e){return null}},this.stringToXML=function(e){try{var t=null;return window.DOMParser?t=(new r).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t)}catch(e){return null}},this}.call({});e.exports=function(e){return d.parseString(e)}},function(e,t,n){var r=n(5);t.DOMImplementation=r.DOMImplementation,t.XMLSerializer=r.XMLSerializer,t.DOMParser=n(18).DOMParser},function(e,t,n){var r=n(2),o=n(5),u=n(19),n=n(20),i=o.DOMImplementation,l=r.NAMESPACE,a=n.ParseError,d=n.XMLReader;function p(e){return e.replace(/\r[\n\u0085]/g,"\n").replace(/[\r\u0085\u2028]/g,"\n")}function s(e){this.options=e||{locator:{}}}function h(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function c(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function m(e,t){(e.currentElement||e.doc).appendChild(t)}s.prototype.parseFromString=function(e,t){var n=this.options,r=new d,a=n.domBuilder||new h,o=n.errorHandler,i=n.locator,s=n.xmlns||{},c=/\/x?html?$/.test(t),t=c?u.HTML_ENTITIES:u.XML_ENTITIES;i&&a.setDocumentLocator(i),r.errorHandler=function(r,o){if(!r){if(a instanceof h)return a;r=a}var e={},i=r instanceof Function;function t(t){var n=r[t];!n&&i&&(n=2==r.length?function(e){r(t,e)}:r),e[t]=n?function(e){n("[xmldom "+t+"]\t"+e+function(){if(o)return"\n@"+(o.systemId||"")+"#[line:"+o.lineNumber+",col:"+o.columnNumber+"]"}())}:function(){}}return o=o||{},t("warning"),t("error"),t("fatalError"),e}(o,i),r.domBuilder=n.domBuilder||a,c&&(s[""]=l.HTML),s.xml=s.xml||l.XML;n=n.normalizeLineEndings||p;return e&&"string"==typeof e?r.parse(n(e),s,t):r.errorHandler.error("invalid doc source"),a.doc},h.prototype={startDocument:function(){this.doc=(new i).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var o=this.doc,i=o.createElementNS(e,n||t),a=r.length;m(this,i),this.currentElement=i,this.locator&&f(this.locator,i);for(var s=0;s<a;s++){e=r.getURI(s);var c=r.getValue(s),u=(n=r.getQName(s),o.createAttributeNS(e,n));this.locator&&f(r.getLocator(s),u),u.value=u.nodeValue=c,i.setAttributeNode(u)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){t=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,t),m(this,t)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){var r;(e=c.apply(this,arguments))&&(r=this.cdata?this.doc.createCDATASection(e):this.doc.createTextNode(e),this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&f(this.locator,r))},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=c.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&f(this.locator,r),m(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;r&&r.createDocumentType&&(n=r.createDocumentType(e,t,n),this.locator&&f(this.locator,n),m(this,n),this.doc.doctype=n)},warning:function(e){},error:function(e){},fatalError:function(e){throw new a(e,this.locator)}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){h.prototype[e]=function(){return null}}),t.__DOMHandler=h,t.normalizeLineEndings=p,t.DOMParser=s},function(e,t,n){n=n(2).freeze;t.XML_ENTITIES=n({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),t.HTML_ENTITIES=n({lt:"<",gt:">",amp:"&",quot:'"',apos:"'",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",times:"×",divide:"÷",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",fnof:"ƒ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",bull:"•",hellip:"…",permil:"‰",prime:"′",Prime:"″",lsaquo:"‹",rsaquo:"›",oline:"‾",euro:"€",trade:"™",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦"}),t.entityMap=t.HTML_ENTITIES},function(e,t,n){var N=n(2).NAMESPACE,r=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,n=new RegExp("[\\-\\.0-9"+r.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),o=new RegExp("^"+r.source+n.source+"*(?::"+r.source+n.source+"*)?$");function U(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,U)}function i(){}function M(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function L(e,t,n){for(var r,o=e.tagName,i=null,a=e.length;a--;){var s,c=e[a],u=c.qName,l=c.value,u=0<(r=u.indexOf(":"))?(s=c.prefix=u.slice(0,r),d=u.slice(r+1),"xmlns"===s&&d):(s=null,"xmlns"===(d=u)&&"");c.localName=d,!1!==u&&(null==i&&(i={},h(n,n={})),n[u]=i[u]=l,c.uri=N.XMLNS,t.startPrefixMapping(u,l))}for(a=e.length;a--;)(s=(c=e[a]).prefix)&&("xml"===s&&(c.uri=N.XML),"xmlns"!==s&&(c.uri=n[s||""]));var d=0<(r=o.indexOf(":"))?(s=e.prefix=o.slice(0,r),e.localName=o.slice(r+1)):(s=null,e.localName=o),p=e.uri=n[s||""];if(t.startElement(p,d,o,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,1;if(t.endElement(p,d,o),i)for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&t.endPrefixMapping(s)}function h(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function H(){this.attributeNames={}}(U.prototype=new Error).name=U.name,i.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),h(t,t={}),function(n,e,r,o,i){function a(e){var t=e.slice(1,-1);return Object.hasOwnProperty.call(r,t)?r[t]:"#"===t.charAt(0)?function(e){if(65535<e){var t=55296+((e-=65536)>>10);return String.fromCharCode(t,56320+(1023&e))}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function t(e){var t;C<e&&(t=n.substring(C,e).replace(/&#?\w+;/g,a),g&&s(C),o.characters(t,0,e-C),C=e)}function s(e,t){for(;f<=e&&(t=m.exec(n));)h=t.index,f=h+t[0].length,g.lineNumber++;g.columnNumber=e-h+1}for(var c,u,l,d,p,h=0,f=0,m=/.*(?:\r\n?|\n)|.*$/g,g=o.locator,y=[{currentNSMap:e}],v={},C=0;;){try{var k,S,b=n.indexOf("<",C);if(b<0)return n.substr(C).match(/^\s*$/)||(S=(k=o.doc).createTextNode(n.substr(C)),k.appendChild(S),o.currentElement=S);switch(C<b&&t(b),n.charAt(b+1)){case"/":var T=n.indexOf(">",b+3),R=n.substring(b+2,T).replace(/[ \t\n\r]+$/g,""),E=y.pop();T<0?(R=n.substring(b+2).replace(/[\s<].*/,""),i.error("end tag name: "+R+" is not complete:"+E.tagName),T=b+1+R.length):R.match(/\s</)&&(R=R.replace(/[\s<].*/,""),i.error("end tag name: "+R+" maybe not complete"),T=b+1+R.length);var w=E.localNSMap,x=E.tagName==R;if(x||E.tagName&&E.tagName.toLowerCase()==R.toLowerCase()){if(o.endElement(E.uri,E.localName,R),w)for(var A in w)Object.prototype.hasOwnProperty.call(w,A)&&o.endPrefixMapping(A);x||i.fatalError("end tag name: "+R+" is not match the current start tagName:"+E.tagName)}else y.push(E);T++;break;case"?":g&&s(b),T=function(e,t,n){var r=e.indexOf("?>",t);if(r){t=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return t?(t[0].length,n.processingInstruction(t[1],t[2]),r+2):-1}return-1}(n,b,o);break;case"!":g&&s(b),T=function(e,o,t,n){if("-"===e.charAt(o+2))return"-"===e.charAt(o+3)?(r=e.indexOf("--\x3e",o+4))>o?(t.comment(e,o+4,r-o-4),r+3):(n.error("Unclosed comment"),-1):-1;if("CDATA["==e.substr(o+3,6)){var r=e.indexOf("]]>",o+9);return t.startCDATA(),t.characters(e,o+9,r-o-9),t.endCDATA(),r+3}var i=function(e){var t,n=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=o,r.exec(e);t=r.exec(e);)if(n.push(t),t[1])return n}(e),a=i.length;if(1<a&&/!doctype/i.test(i[0][0])){n=i[1][0],r=!1,e=!1;3<a&&(/^public$/i.test(i[2][0])?(r=i[3][0],e=4<a&&i[4][0]):/^system$/i.test(i[2][0])&&(e=i[3][0]));a=i[a-1];return t.startDTD(n,r,e),t.endDTD(),a.index+a[0].length}return-1}(n,b,o,i);break;default:g&&s(b);var B=new H,O=y[y.length-1].currentNSMap,I=(T=function(e,t,r,n,o,i){function a(e,t,n){r.attributeNames.hasOwnProperty(e)&&i.fatalError("Attribute "+e+" redefined"),r.addValue(e,t.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,o),n)}for(var s,c=++t,u=0;;){var l=e.charAt(c);switch(l){case"=":if(1===u)s=e.slice(t,c),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(i.warning('attribute value must after "="'),s=e.slice(t,c)),!(0<(c=e.indexOf(l,t=c+1))))throw new Error("attribute value no end '"+l+"' match");a(s,d=e.slice(t,c),t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');a(s,d=e.slice(t,c),t),i.warning('attribute "'+s+'" missed start quot('+l+")!!"),t=c+1,u=5}break;case"/":switch(u){case 0:r.setTagName(e.slice(t,c));case 5:case 6:case 7:u=7,r.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return i.error("unexpected end of input"),0==u&&r.setTagName(e.slice(t,c)),c;case">":switch(u){case 0:r.setTagName(e.slice(t,c));case 5:case 6:case 7:break;case 4:case 1:"/"===(d=e.slice(t,c)).slice(-1)&&(r.closed=!0,d=d.slice(0,-1));case 2:2===u&&(d=s),4==u?(i.warning('attribute "'+d+'" missed quot(")!'),a(s,d,t)):(N.isHTML(n[""])&&d.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+d+'" missed value!! "'+d+'" instead!!'),a(d,d,t));break;case 3:throw new Error("attribute value missed!!")}return c;case"":l=" ";default:if(l<=" ")switch(u){case 0:r.setTagName(e.slice(t,c)),u=6;break;case 1:s=e.slice(t,c),u=2;break;case 4:var d=e.slice(t,c);i.warning('attribute "'+d+'" missed quot(")!!'),a(s,d,t);case 5:u=6}else switch(u){case 2:r.tagName,N.isHTML(n[""])&&s.match(/^(?:disabled|checked|selected)$/i)||i.warning('attribute "'+s+'" missed value!! "'+s+'" instead2!!'),a(s,s,t),t=c,u=1;break;case 5:i.warning('attribute space is required"'+s+'"!!');case 6:u=1,t=c;break;case 3:u=4,t=c;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}(n,b,B,O,a,i),B.length);if(!B.closed&&(c=n,u=T,l=B.tagName,p=void 0,null==(p=(d=v)[l])&&((p=c.lastIndexOf("</"+l+">"))<u&&(p=c.lastIndexOf("</"+l)),d[l]=p),p<u)&&(B.closed=!0,r.nbsp||i.warning("unclosed xml attribute")),g&&I){for(var _=M(g,{}),D=0;D<I;D++){var P=B[D];s(P.offset),P.locator=M(g,{})}o.locator=_,L(B,o,O)&&y.push(B),o.locator=g}else L(B,o,O)&&y.push(B);N.isHTML(B.uri)&&!B.closed?T=function(e,t,n,r,o){if(/^(?:script|textarea)$/i.test(n)){var i=e.indexOf("</"+n+">",t),e=e.substring(t+1,i);if(/[&<]/.test(e))return/^script$/i.test(n)||(e=e.replace(/&#?\w+;/g,r)),o.characters(e,0,e.length),i}return t+1}(n,T,B.tagName,a,o):T++}}catch(n){if(n instanceof U)throw n;i.error("element parse error: "+n),T=-1}C<T?C=T:t(Math.max(b,C)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},H.prototype={setTagName:function(e){if(!o.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},addValue:function(e,t,n){if(!o.test(e))throw new Error("invalid attribute:"+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},t.XMLReader=i,t.ParseError=U},function(e,t,n){function o(e,u){function l(e,t,n,r,o){var i=void 0!==u.indent?u.indent:"\t",n=[i=u.prettyPrint?"\n"+new Array(r).join(i):"","<",e=u.removeIllegalNameCharacters?e.replace(a,"_"):e,n||""];return t&&0<t.length?(n.push(">"),n.push(t),o&&n.push(i),n.push("</"),n.push(e),n.push(">")):n.push("/>"),n.join("")}return function t(e,n,r){var o=d(e);switch((Array.isArray?Array.isArray(e):e instanceof Array)?o="array":e instanceof Date&&(o="date"),o){case"array":var i=[];return e.map(function(e){i.push(t(e,0,r+1))}),u.prettyPrint&&i.push("\n"),i.join("");case"date":return e.toJSON?e.toJSON():e+"";case"object":var a,s=[];for(a in e)if(e.hasOwnProperty(a))if(e[a]instanceof Array)for(var c=0;c<e[a].length;c++)e[a].hasOwnProperty(c)&&s.push(l(a,t(e[a][c],0,r+1),null,r+1,function(e){var t=[];if(e instanceof Object)for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t}(e[a][c]).length));else s.push(l(a,t(e[a],0,r+1),null,r+1));return u.prettyPrint&&0<s.length&&s.push("\n"),s.join("");case"function":return e();default:return u.escape?(""+e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(p,""):""+e}}(e,0,0)}function i(e){var t=['<?xml version="1.0" encoding="UTF-8"'];return e&&t.push(' standalone="yes"'),t.push("?>"),t.join("")}var d=n(0),n="a-zA-Z_À-ÖØ-öø-ÿͰ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿿、-퟿豈-﷏ﷰ-�",a=new RegExp("^([^"+n+"])|^((x|X)(m|M)(l|L))|([^"+n+"-.0-9·̀-ͯ‿⁀])","g"),p=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm;e.exports=function(e,t){if(t=t||{xmlHeader:{standalone:!0},prettyPrint:!0,indent:"  ",escape:!0},"string"==typeof e)try{e=JSON.parse(e.toString())}catch(e){return!1}var n="",r="";return t&&("object"==d(t)?(t.xmlHeader&&(n=i(!!t.xmlHeader.standalone)),void 0!==t.docType&&(r="<!DOCTYPE "+t.docType+">")):n=i()),[n,(t=t||{}).prettyPrint&&r?"\n":"",r,o(e,t)].join("").replace(/\n{2,}/g,"\n").replace(/\s+$/g,"")}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,n){var r=function(){"use strict";var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},a=function(){return(a=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function e(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})}function s(n,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((a=0<(a=s.trys).length&&a[a.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var o="__BEACON_",t="__BEACON_deviceId",c="last_report_time",u="sending_event_ids",l="beacon_config",i="beacon_config_request_time",d=(n.prototype.indexOf=function(e,t){for(var n=0;n<e.length;n++)if(e[n].callback===t)return n;return-1},n.prototype.on=function(e,t,n){if(void 0===n&&(n=0),this){var r=(r=this.__EventsList[e])||(this.__EventsList[e]=[]);return-1!==this.indexOf(r,t)?this:(r.push({name:e,type:n||0,callback:t}),this)}},n.prototype.one=function(e,t){this.on(e,t,1)},n.prototype.remove=function(e,t){if(this){var n=this.__EventsList[e];if(!n)return null;if(t)return n.length&&(t=this.indexOf(n,t),n.splice(t,1)),this;try{delete this.__EventsList[e]}catch(e){}return null}},n);function n(){var a=this;this.emit=function(e,t){if(a){var n;if(null!=(r=a.__EventsList[e])&&r.length)for(var r=r.slice(),o=0;o<r.length;o++){n=r[o];try{var i=n.callback.apply(a,[t]);if(1===n.type&&a.remove(e,n.callback),!1===i)break}catch(e){throw e}}return a}},this.__EventsList={}}function p(e,t){for(var n={},r=0,o=Object.keys(e);r<o.length;r++){var i=o[r],a=e[i];if("string"==typeof a)n[h(i)]=h(a);else{if(t)throw new Error("value mast be string  !!!!");n[h(String(i))]=h(String(a))}}return n}function h(e){if("string"!=typeof e)return e;try{return e.replace(new RegExp("\\|","g"),"%7C").replace(new RegExp("\\&","g"),"%26").replace(new RegExp("\\=","g"),"%3D").replace(new RegExp("\\+","g"),"%2B")}catch(e){return""}}function f(e){return String(e.A99)+String(e.A100)}function m(){}var g=(R.prototype.onUserAction=function(e,t){this.preReport(e,t,!1)},R.prototype.onDirectUserAction=function(e,t){this.preReport(e,t,!0)},R.prototype.preReport=function(e,t,n){e?this.strategy.isEventUpOnOff()&&(this.strategy.isBlackEvent(e)||this.strategy.isSampleEvent(e)||this.onReport(e,t,n)):this.errorReport.reportError("602"," no eventCode")},R.prototype.addAdditionalParams=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];this.additionalParams[r]=e[r]}},R.prototype.setChannelId=function(e){this.commonInfo.channelID=String(e)},R.prototype.setOpenId=function(e){this.commonInfo.openid=String(e)},R.prototype.setUnionid=function(e){this.commonInfo.unid=String(e)},R.prototype.getDeviceId=function(){return this.commonInfo.deviceId},R.prototype.getCommonInfo=function(){return this.commonInfo},R.prototype.removeSendingId=function(e){try{var t=JSON.parse(this.storage.getItem(u)),n=t.indexOf(e);-1!=n&&(t.splice(n,1),this.storage.setItem(u,JSON.stringify(t)))}catch(e){}},R),y=(T.prototype.reportError=function(e,t){this.requestParams._dc=Math.random(),this.requestParams.error_msg=t,this.requestParams.error_code=e,this.network.get(this.uploadUrl,{params:this.requestParams}).catch(function(e){})},T),v=(b.prototype.requestConfig=function(e,t,n){var r=this;this.storage.setItem(i,Date.now().toString()),n.post("https://oth.str.beacon.qq.com/trpc.beacon.configserver.BeaconConfigService/QueryConfig",{platformId:"undefined"==typeof wx?"3":"4",mainAppKey:this.appkey,appVersion:e,sdkVersion:t.sdkVersion,osVersion:t.userAgent,model:"",packageName:"",params:{A3:t.deviceId}}).then(function(e){if(0==e.data.ret)try{var t=JSON.parse(e.data.beaconConfig);t&&(r.processData(t),r.storage.setItem(l,e.data.beaconConfig))}catch(e){}else r.processData(null),r.storage.setItem(l,"")}).catch(function(e){})},b.prototype.processData=function(e){var t;this.strategy.isEventUpOnOff=null!==(t=null==e?void 0:e.isEventUpOnOff)&&void 0!==t?t:this.strategy.isEventUpOnOff,this.strategy.httpsUploadUrl=null!==(t=null==e?void 0:e.httpsUploadUrl)&&void 0!==t?t:this.strategy.httpsUploadUrl,this.strategy.requestInterval=null!==(t=null==e?void 0:e.requestInterval)&&void 0!==t?t:this.strategy.requestInterval,this.strategy.blacklist=null!==(t=null==e?void 0:e.blacklist)&&void 0!==t?t:this.strategy.blacklist,this.strategy.samplelist=null!==(e=null==e?void 0:e.samplelist)&&void 0!==e?e:this.strategy.samplelist;for(var n=0,r=this.strategy.samplelist;n<r.length;n++){var o=r[n].split(",");2==o.length&&(this.realSample[o[0]]=o[1])}},b.prototype.needRequestConfig=function(){if(!this.needQueryConfig)return!1;var e=Number(this.storage.getItem(i));return Date.now()-e>60*this.strategy.requestInterval*1e3},b.prototype.getUploadUrl=function(){return this.strategy.httpsUploadUrl+"?appkey="+this.appkey},b.prototype.isBlackEvent=function(e){return-1!=this.strategy.blacklist.indexOf(e)},b.prototype.isEventUpOnOff=function(){return this.strategy.isEventUpOnOff},b.prototype.isSampleEvent=function(e){return!!Object.prototype.hasOwnProperty.call(this.realSample,e)&&this.realSample[e]<Math.floor(Math.random()*Math.floor(1e4))},b),C="session_storage_key",k=(S.prototype.getSession=function(){this.getSessionStackDepth+=1;var e=this.storage.getItem(C);if(!e)return this.createSession();var t="",n=0;try{var r=JSON.parse(e)||{sessionId:void 0,sessionStart:void 0};if(!r.sessionId||!r.sessionStart)return this.createSession();var o=Number(this.storage.getItem(c));if(Date.now()-o>this.duration)return this.createSession();t=r.sessionId,n=r.sessionStart,this.getSessionStackDepth=0}catch(e){}return{sessionId:t,sessionStart:n}},S.prototype.createSession=function(){var e=Date.now(),t={sessionId:this.appkey+"_"+e.toString(),sessionStart:e};this.storage.setItem(C,JSON.stringify(t)),this.storage.setItem(c,e.toString());var n="is_new_user",e=this.storage.getItem(n);return this.getSessionStackDepth<=1&&this.beacon.onDirectUserAction("rqd_applaunched",{A21:e?"N":"Y"}),this.storage.setItem(n,JSON.stringify(!1)),t},S);function S(e,t,n){this.getSessionStackDepth=0,this.beacon=n,this.storage=e,this.duration=t,this.appkey=n.config.appkey}function b(e,t,n,r,o){this.strategy={isEventUpOnOff:!0,httpsUploadUrl:"https://otheve.beacon.qq.com/analytics/v2_upload",requestInterval:30,blacklist:[],samplelist:[]},this.realSample={},this.appkey="",this.needQueryConfig=!0,this.appkey=t.appkey,this.storage=r,this.needQueryConfig=e;try{var i=JSON.parse(this.storage.getItem(l));i&&this.processData(i)}catch(e){}t.isOversea&&(this.strategy.httpsUploadUrl="https://svibeacon.onezapp.com/analytics/v2_upload"),!t.isOversea&&this.needRequestConfig()&&this.requestConfig(t.appVersion,n,o)}function T(e,t,n,r){this.requestParams={},this.network=r,this.requestParams.attaid="00400014144",this.requestParams.token="6478159937",this.requestParams.product_id=e.appkey,this.requestParams.platform=n,this.requestParams.uin=t.deviceId,this.requestParams.model="",this.requestParams.os=n,this.requestParams.app_version=e.appVersion,this.requestParams.sdk_version=t.sdkVersion,this.requestParams.error_stack="",this.uploadUrl=e.isOversea?"https://htrace.wetvinfo.com/kv":"https://h.trace.qq.com/kv"}function R(t){var n=this;this.lifeCycle=new d,this.uploadJobQueue=[],this.additionalParams={},this.delayTime=0,this._normalLogPipeline=function(n){if(!n||!n.reduce||!n.length)throw new TypeError("createPipeline 方法需要传入至少有一个 pipe 的数组");return 1===n.length?function(e,t){n[0](e,t||m)}:n.reduce(function(n,r){return function(e,t){return void 0===t&&(t=m),n(e,function(e){return null==r?void 0:r(e,t)})}})}([function(t){n.send({url:n.strategy.getUploadUrl(),data:t,method:"post",contentType:"application/json;charset=UTF-8"},function(){var e=n.config.onReportSuccess;"function"==typeof e&&e(JSON.stringify(t.events))},function(){var e=n.config.onReportFail;"function"==typeof e&&e(JSON.stringify(t.events))})}]),function(e){if(!Boolean(t.appkey))throw e instanceof Error?e:new Error(e)}("appkey must be initial"),this.config=a({},t)}function E(){var e=navigator.userAgent,t=-1<e.indexOf("compatible")&&-1<e.indexOf("MSIE"),n=-1<e.indexOf("Edge")&&!t,r=-1<e.indexOf("Trident")&&-1<e.indexOf("rv:11.0");if(t){new RegExp("MSIE (\\d+\\.\\d+);").test(e);e=parseFloat(RegExp.$1);return 7==e?7:8==e?8:9==e?9:10==e?10:6}return n?-2:r?11:-1}var w=function(){return(w=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},x=(M.canUseDB=function(){return!(null===window||void 0===window||!window.indexedDB)},M.prototype.openDB=function(){var s=this;return new Promise(function(e,t){if(!M.canUseDB())return t({message:"当前不支持 indexeddb"});var n=s.config,r=n.name,o=n.version,i=n.stores,a=indexedDB.open(r,o);a.onsuccess=function(){s.db=a.result,e(),w({result:1,func:"open",params:JSON.stringify(s.config)},s.reportOptions)},a.onerror=function(e){t(e),w({result:0,func:"open",params:JSON.stringify(s.config),error_msg:null===(e=null===(e=e.target)||void 0===e?void 0:e.error)||void 0===e?void 0:e.message},s.reportOptions)},a.onupgradeneeded=function(){s.db=a.result;try{null==i||i.forEach(function(e){s.createStore(e)})}catch(e){w({result:0,func:"open",params:JSON.stringify(s.config),error_msg:e.message},s.reportOptions),t(e)}}})},M.prototype.useStore=function(e){return this.storeName=e,this},M.prototype.deleteDB=function(){var r=this;return this.closeDB(),new Promise(function(e,t){var n=indexedDB.deleteDatabase(r.config.name);n.onsuccess=function(){return e()},n.onerror=t})},M.prototype.closeDB=function(){var e;null===(e=this.db)||void 0===e||e.close(),this.db=null},M.prototype.getStoreCount=function(){var r=this;return new Promise(function(e,t){var n=r.getStore("readonly").count();n.onsuccess=function(){return e(n.result)},n.onerror=t})},M.prototype.clearStore=function(){var r=this;return new Promise(function(e,t){var n=r.getStore("readwrite").clear();n.onsuccess=function(){return e()},n.onerror=t})},M.prototype.add=function(r,o){var i=this;return new Promise(function(e,t){var n=i.getStore("readwrite").add(r,o);n.onsuccess=function(){e(n.result)},n.onerror=t})},M.prototype.put=function(r,o){var i=this;return new Promise(function(e,t){var n=i.getStore("readwrite").put(r,o);n.onsuccess=function(){e(n.result)},n.onerror=t})},M.prototype.getStoreAllData=function(){var o=this;return new Promise(function(t,e){var n=o.getStore("readonly").openCursor(),r=[];n.onsuccess=function(){var e;null!==(e=n.result)&&void 0!==e&&e.value?(e=n.result.value,r.push(e),n.result.continue()):t(r)},n.onerror=e})},M.prototype.getDataRangeByIndex=function(a,s,c,u,l){var d=this;return new Promise(function(t,e){var n=d.getStore().index(a),r=IDBKeyRange.bound(s,c,u,l),o=[],i=n.openCursor(r);i.onsuccess=function(){var e;null!==(e=null==i?void 0:i.result)&&void 0!==e&&e.value?(o.push(null==i?void 0:i.result.value),null==i||i.result.continue()):t(o)},i.onerror=e})},M.prototype.removeDataByIndex=function(i,a,s,c,u){var l=this;return new Promise(function(t,e){var n=l.getStore("readwrite").index(i),r=IDBKeyRange.bound(a,s,c,u),r=n.openCursor(r),o=0;r.onsuccess=function(e){e=e.target.result;e?(o+=1,e.delete(),e.continue()):t(o)},r.onerror=e})},M.prototype.createStore=function(e){var t,n=e.name,r=e.indexes,r=void 0===r?[]:r,e=e.options;this.db&&(this.db.objectStoreNames.contains(n)&&this.db.deleteObjectStore(n),t=this.db.createObjectStore(n,e),r.forEach(function(e){t.createIndex(e.indexName,e.keyPath,e.options)}))},M.prototype.getStore=function(e){var t;return void 0===e&&(e="readonly"),null===(t=this.db)||void 0===t?void 0:t.transaction(this.storeName,e).objectStore(this.storeName)},M),A="event_table_v3",B="eventId",O=(U.prototype.getCount=function(){var e=this;return this.readyExec(function(){return e.db.getStoreCount()})},U.prototype.setItem=function(e,t){var n=this;return this.readyExec(function(){return n.db.add({eventId:e,value:t})})},U.prototype.getItem=function(n){return e(this,void 0,void 0,function(){var t=this;return s(this,function(e){return[2,this.readyExec(function(){return t.db.getDataRangeByIndex(B,n,n)})]})})},U.prototype.removeItem=function(e){var t=this;return this.readyExec(function(){return t.db.removeDataByIndex(B,e,e)})},U.prototype.updateItem=function(e,t){var n=this;return this.readyExec(function(){return n.db.put({eventId:e,value:t})})},U.prototype.iterate=function(t){var e=this;return this.readyExec(function(){return e.db.getStoreAllData().then(function(e){e.forEach(function(e){t(e.value)})})})},U.prototype.open=function(){return e(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.taskQueue=this.taskQueue.then(function(){return t.db.openDB()}),[4,this.taskQueue];case 1:return e.sent(),this.isReady=!0,this.db.useStore(A),[2]}})})},U.prototype.readyExec=function(e){return this.isReady?e():(this.taskQueue=this.taskQueue.then(function(){return e()}),this.taskQueue)},U),I=(N.prototype.getCount=function(){return this.storage.getStoreCount()},N.prototype.removeItem=function(e){this.storage.removeItem(e),delete this.keyObject[e]},N.prototype.setItem=function(e,t){var n=JSON.stringify(t);this.storage.setItem(e,n),this.keyObject[e]=t},N.prototype.iterate=function(e){for(var t=Object.keys(this.keyObject),n=0;n<t.length;n++){var r=this.storage.getItem(t[n]);e(JSON.parse(r))}},N),_=(P.prototype.getCount=function(){return e(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.store.getCount()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,Promise.reject()];case 3:return[2]}})})},P.prototype.insertEvent=function(r,o){return e(this,void 0,void 0,function(){var t,n;return s(this,function(e){switch(e.label){case 0:if(1e4<=this.dbEventCount)return[2,Promise.reject()];t=f(r.mapValue),e.label=1;case 1:return e.trys.push([1,3,,4]),this.dbEventCount++,[4,this.store.setItem(t,r)];case 2:return[2,e.sent()];case 3:return n=e.sent(),o&&o(n,r),this.dbEventCount--,[2,Promise.reject()];case 4:return[2]}})})},P.prototype.getEvents=function(){return e(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:t=[],e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.store.iterate(function(e){t.push(e)})];case 2:case 3:return e.sent(),[2,Promise.all(t)];case 4:return[2]}})})},P.prototype.removeEvent=function(n){return e(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:t=f(n.mapValue),e.label=1;case 1:return e.trys.push([1,3,,4]),this.dbEventCount--,[4,this.store.removeItem(t)];case 2:return[2,e.sent()];case 3:return e.sent(),this.dbEventCount++,[2,Promise.reject()];case 4:return[2]}})})},P),D=function(){return(D=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function P(e,t){var n=this;(this.dbEventCount=0)<E()||!window.indexedDB||/X5Lite/.test(navigator.userAgent)?(this.store=new I(t),this.dbEventCount=this.store.getCount()):(this.store=new O(e),this.getCount().then(function(e){n.dbEventCount=e}).catch(function(e){}))}function N(e){this.keyObject={},this.storage=e}function U(e){this.isReady=!1,this.taskQueue=Promise.resolve(),this.db=new x({name:"Beacon_"+e+"_V3",version:1,stores:[{name:A,options:{keyPath:B},indexes:[{indexName:B,keyPath:B,options:{unique:!0}}]}]}),this.open()}function M(e,t){void 0===t&&(t={}),this.reportOptions={},this.config=e,this.reportOptions=t}function L(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function H(e,t){var n=[null,void 0,"",NaN].includes(e);if(t.isSkipEmpty&&n)return null;n=!t.isSkipEmpty&&n?"":e;try{return t.encode?encodeURIComponent(n):n}catch(e){return null}}(q={})[q.equal=0]="equal",q[q.low=-1]="low",q[q.high=1]="high";var j=function(){return(j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function F(e,a,s,c){return new(s=s||Promise)(function(n,t){function r(e){try{i(c.next(e))}catch(e){t(e)}}function o(e){try{i(c.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(r,o)}i((c=c.apply(e,a||[])).next())})}function K(n,r){var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=2&t[0]?i.return:t[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,t[1])).done)return a;switch(i=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!((a=0<(a=s.trys).length&&a[a.length-1])||6!==t[0]&&2!==t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],i=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var q=(X.prototype.use=function(e,t){return this.interceptors.push({resolved:e,rejected:t}),this.interceptors.length-1},X.prototype.traverse=function(e,t){void 0===t&&(t=!1);var r=Promise.resolve(e);return(t?Array.prototype.reduceRight:Array.prototype.reduce).call(this.interceptors,function(e,t){var n;return t&&(n=t.resolved,t=t.rejected,r=r.then(n,t)),e},""),r},X.prototype.eject=function(e){this.interceptors[e]&&(this.interceptors[e]=null)},X),z={defaults:{timeout:0,method:"GET",mode:"cors",redirect:"follow",credentials:"same-origin"},headers:{common:{Accept:"application/json, text/plain, */*"},POST:{"Content-Type":"application/x-www-form-urlencoded"},PUT:{"Content-Type":"application/x-www-form-urlencoded"},PATCH:{"Content-Type":"application/x-www-form-urlencoded"}},baseURL:"",polyfillUrl:"https://vm.gtimg.cn/comps/script/fetch.min.js",interceptors:{request:new q,response:new q}},G=/^([a-z][a-z\d+\-.]*:)?\/\//i,V=Object.prototype.toString;function X(){this.interceptors=[]}function W(n){return F(this,void 0,void 0,function(){var t;return K(this,function(e){switch(e.label){case 0:if(window.fetch)return[2];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,(o={src:n},new Promise(function(t,e){if(i&&document.querySelectorAll("script[data-tag="+i+"]").length)return t();var n=document.createElement("script"),r=D({type:"text/javascript",charset:"utf-8"},o);Object.keys(r).forEach(function(e){return function(e,t,n){if(e)return void 0===n?e.getAttribute(t):e.setAttribute(t,n)}(n,e,r[e])}),i&&(n.dataset.tag=i),n.onload=function(){return t()},n.onreadystatechange=function(){var e=n.readyState;["complete","loaded"].includes(e)&&(n.onreadystatechange=null,t())},n.onerror=e,document.body.appendChild(n)}))];case 2:return e.sent(),[3,4];case 3:throw t=e.sent(),new Error("加载 polyfill "+n+" 失败: "+t.message);case 4:return[2]}var o,i})})}function Q(m){return F(this,void 0,void 0,function(){var o,i,a,s,c,u,l,d,p,h,f;return K(this,function(e){switch(e.label){case 0:return o=z.baseURL,i=z.defaults,a=z.interceptors,[4,W(z.polyfillUrl)];case 1:return e.sent(),(u=j(j({},i),m)).headers||(u.headers=function(e){e=z.headers[e=void 0===e?"GET":e]||{};return j(j({},z.headers.common),e)}(u.method)),r=u,["Accept","Content-Type"].forEach(function(e){var t,n=e;(t=r.headers)&&Object.keys(t).forEach(function(e){e!==n&&e.toUpperCase()===n.toUpperCase()&&(t[n]=t[e],delete t[e])})}),function(e){if("[object Object]"===V.call(e)){e=Object.getPrototypeOf(e);return null===e||e===Object.prototype}}(r.body)&&(r.body=JSON.stringify(r.body),r.headers&&(r.headers["Content-Type"]="application/json;charset=utf-8")),[4,a.request.traverse(u,!0)];case 2:if((s=e.sent())instanceof Error)throw s;return s.url=(t=o,n=s.url,!t||G.test(n)?n:t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,"")),d=s.url,c=s.timeout,l=s.params,u=s.method,u=["GET","DELETE","OPTIONS","HEAD"].includes(void 0===u?"GET":u)&&!!l,l=u?function(e,n){void 0===n&&(n={encode:!0,isSkipEmpty:!1});var r,t=e.url,o=e.query,i=void 0===o?{}:o,a=e.hash,s=t.split("#"),o=s[0],e=s[1],s=void 0===e?"":e,e=o.split("?")[0],c=[],o=H(a||s,n),u=D(D({},(a=t.split("#"),s=a[0],t=a[1],a=void 0===t?"":t,s=(t=s.split("?"))[0],t=void 0===(t=t[1])?"":t,a=L(a),r=Object.create(null),t.split("&").forEach(function(e){var t=e.split("="),e=t[0],t=t[1],t=void 0===t?"":t,e=L(e),t=L(t);null===e||null===t||""===e&&""===t||r[e]||(r[e]=t)}),{url:s,query:r,hash:a}).query),i);return Object.keys(u).forEach(function(e){var t=H(e,n),e=H(u[e],n);null!==t&&null!==e&&c.push(t+"="+e)}),e+(c.length?"?"+c.join("&"):"")+(o?"#"+o:"")}({url:d,query:l}):d,d=[],c&&!s.signal&&(h=new Promise(function(e){p=setTimeout(function(){e(new Error("timeout"))},c)}),d.push(h),h=new AbortController,s.signal=h.signal),d.push(fetch(l,s).catch(function(e){return e})),[4,Promise.race(d)];case 3:return f=e.sent(),p&&clearTimeout(p),[4,a.response.traverse(f)];case 4:if((f=e.sent())instanceof Error)throw null==h||h.abort(),f;return[2,f]}var t,n,r})})}var J,$=(ne.prototype.get=function(r,o){return e(this,void 0,void 0,function(){var t,n;return s(this,function(e){switch(e.label){case 0:return[4,Q(a({url:r},o))];case 1:return[4,(t=e.sent()).json()];case 2:return n=e.sent(),[2,Promise.resolve({data:n,status:t.status,statusText:t.statusText,headers:t.headers})]}})})},ne.prototype.post=function(r,o,i){return e(this,void 0,void 0,function(){var t,n;return s(this,function(e){switch(e.label){case 0:return[4,Q(a({url:r,body:o,method:"POST"},i))];case 1:return[4,(t=e.sent()).json()];case 2:return n=e.sent(),[2,Promise.resolve({data:n,status:t.status,statusText:t.statusText,headers:t.headers})]}})})},ne),Y=(te.prototype.getItem=function(e){try{return window.localStorage.getItem(this.getStoreKey(e))}catch(e){return""}},te.prototype.removeItem=function(e){try{window.localStorage.removeItem(this.getStoreKey(e))}catch(e){}},te.prototype.setItem=function(e,t){try{window.localStorage.setItem(this.getStoreKey(e),t)}catch(e){}},te.prototype.setSessionItem=function(e,t){try{window.sessionStorage.setItem(this.getStoreKey(e),t)}catch(e){}},te.prototype.getSessionItem=function(e){try{return window.sessionStorage.getItem(this.getStoreKey(e))}catch(e){return""}},te.prototype.getStoreKey=function(e){return o+this.appkey+"_"+e},te.prototype.createDeviceId=function(){try{var e=window.localStorage.getItem(t);return e||(e=function(){for(var e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz0123456789",t="",n=0;n<32;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}(),window.localStorage.setItem(t,e)),e}catch(e){return""}},te.prototype.clear=function(){try{for(var e=window.localStorage.length,t=0;t<e;t++){var n=window.localStorage.key(t);(null==n?void 0:n.substr(0,9))==o&&window.localStorage.removeItem(n)}}catch(e){}},te.prototype.getStoreCount=function(){var e=0;try{e=window.localStorage.length}catch(e){}return e},te),Z="logid_start",ee="4.5.14-web";function te(e){this.appkey=e}function ne(i){z.interceptors.request.use(function(e){var t=e.url,n=e.method,r=e.body,o=r;return i.onReportBeforeSend&&(o=null!=(r=i.onReportBeforeSend({url:t,method:n,data:r?JSON.parse(r):null}))&&r.data?JSON.stringify(r.data):null),"GET"!=n&&o?a(a({},e),{body:o}):e})}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(re,J=g),re.prototype.initSession=function(e){var t=18e5;e.sessionDuration&&3e4<e.sessionDuration&&(t=e.sessionDuration),this.beaconSession=new k(this.storage,t,this)},re.prototype.initCommonInfo=function(e){var t=Number(this.storage.getItem(c));try{var n=JSON.parse(this.storage.getItem(u));(3e4<Date.now()-t||!n)&&this.storage.setItem(u,JSON.stringify([]))}catch(e){}e.uploadUrl&&(this.uploadUrl=e.uploadUrl+"?appkey="+e.appkey);n=[window.screen.width,window.screen.height];window.devicePixelRatio&&n.push(window.devicePixelRatio),this.commonInfo={deviceId:this.storage.createDeviceId(),language:navigator&&navigator.language||"zh_CN",query:window.location.search,userAgent:navigator.userAgent,pixel:n.join("*"),channelID:e.channelID?String(e.channelID):"",openid:e.openid?String(e.openid):"",unid:e.unionid?String(e.unionid):"",sdkVersion:ee},this.config.appVersion=e.versionCode?String(e.versionCode):"",this.config.strictMode=e.strictMode},re.prototype.cycleTask=function(e){var t=this;this.intervalID=window.setInterval(function(){t.pauseSearching||t.store.getEvents().then(function(e){0==e.length&&(t.pauseSearching=!0);var n=[],r=(r=JSON.parse(t.storage.getItem(u)))||[];e&&e.forEach(function(e){var t=f(e.mapValue);-1==r.indexOf(t)&&(n.push(e),r.push(t))}),0!=n.length&&(t.storage.setItem(u,JSON.stringify(r)),t._normalLogPipeline(t.assembleData(n)))}).catch(function(e){})},e)},re.prototype.onReport=function(e,t,n){var r,o=this;this.isUnderIE8?this.errorReport.reportError("601","UnderIE8"):(this.pauseSearching=!1,r=this.generateData(e,t,n),n&&0==this.delayTime&&!this.underWeakNet?this._normalLogPipeline(this.assembleData(r)):(n=r.shift())&&this.store.insertEvent(n,function(e){e&&o.errorReport.reportError("604","insertEvent fail!")}).catch(function(e){o._normalLogPipeline(o.assembleData(r))}))},re.prototype.onSendBeacon=function(e,t){this.isUnderIE?this.errorReport.reportError("605","UnderIE"):(this.pauseSearching=!1,t=this.assembleData(this.generateData(e,t,!0)),"function"==typeof navigator.sendBeacon&&navigator.sendBeacon(this.uploadUrl||this.strategy.getUploadUrl(),JSON.stringify(t)))},re.prototype.generateData=function(e,t,n){var r=[],o="4.5.14-web_"+(n?"direct_log_id":"normal_log_id"),i=(i=Number(this.storage.getItem(o)))||1;return t=a(a({},t),{A99:n?"Y":"N",A100:i.toString(),A72:ee,A88:this.logidStartTime}),this.storage.setItem(o,(++i).toString()),r.push({eventCode:e,eventTime:Date.now().toString(),mapValue:p(t,this.config.strictMode)}),r},re.prototype.assembleData=function(e){var t=this.beaconSession.getSession();return{appVersion:this.config.appVersion?h(this.config.appVersion):"",sdkId:"js",sdkVersion:ee,mainAppKey:this.config.appkey,platformId:3,common:p(a(a({},this.additionalParams),{A2:this.commonInfo.deviceId,A8:this.commonInfo.openid,A12:this.commonInfo.language,A17:this.commonInfo.pixel,A23:this.commonInfo.channelID,A50:this.commonInfo.unid,A76:t.sessionId,A101:this.commonInfo.userAgent,A102:window.location.href,A104:document.referrer,A119:this.commonInfo.query,A153:this.qimei36}),!1),events:e}},re.prototype.monitorUploadFailed=function(){this.uselessCycleTaskNum++,5<=this.uselessCycleTaskNum&&(window.clearInterval(this.intervalID),this.cycleTask(6e4),this.underWeakNet=!0)},re.prototype.doCustomCycleTask=function(){5<=this.uselessCycleTaskNum&&(window.clearInterval(this.intervalID),this.cycleTask(this.initDelayTime)),this.uselessCycleTaskNum=0,this.underWeakNet=!1},re;function re(e){var i=J.call(this,e)||this;i.qimei36="",i.uselessCycleTaskNum=0,i.underWeakNet=!1,i.pauseSearching=!1,i.send=function(r,n,o){i.storage.setItem(c,Date.now().toString()),i.network.post(i.uploadUrl||i.strategy.getUploadUrl(),r.data).then(function(e){var t;100==(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.result)?i.delayTime=1e3*e.data.delayTime:i.delayTime=0,n&&n(r.data),r.data.events.forEach(function(e){i.store.removeEvent(e).then(function(){i.removeSendingId(f(e.mapValue))})}),i.doCustomCycleTask()}).catch(function(e){var t=r.data.events;i.errorReport.reportError(e.code?e.code.toString():"600",e.message),o&&o(r.data);var n=JSON.parse(i.storage.getItem(u));t.forEach(function(e){n&&-1!=n.indexOf(f(e))&&i.store.insertEvent(e,function(e,t){e&&i.errorReport.reportError("604","insertEvent fail!")}),i.removeSendingId(f(e))}),i.monitorUploadFailed()})};var t,n,o,r=E();return i.isUnderIE8=0<r&&r<8,i.isUnderIE8||(i.isUnderIE=0<r,e.needInitQimei&&(t=e.appkey,n=function(e){i.qimei36=e.q36},void 0===o&&(o=Date.now()+"-"+Math.random()),new Promise(function(e,t){var n,r;document.getElementById(o)?e(void 0):(n=document.getElementsByTagName("head")[0],(r=document.createElement("script")).onload=function(){return function(){r.onload=null,e(void 0)}},r.onerror=function(e){r.onerror=null,n.removeChild(r),t(e)},r.src="https://tun-cos-1258344701.file.myqcloud.com/fp.js",r.id=o,n.appendChild(r))}).then(function(){(new Fingerprint).getQimei36(t,n)}).catch(function(e){})),i.network=new $(e),i.storage=new Y(e.appkey),i.initCommonInfo(e),i.store=new _(e.appkey,i.storage),i.errorReport=new y(i.config,i.commonInfo,"web",i.network),i.strategy=new v(null==e.needQueryConfig||e.needQueryConfig,i.config,i.commonInfo,i.storage,i.network),i.logidStartTime=i.storage.getItem(Z),i.logidStartTime||(i.logidStartTime=Date.now().toString(),i.storage.setItem(Z,i.logidStartTime)),r=i.logidStartTime,r=Date.now()-Number.parseFloat(r),365<=Math.floor(r/864e5)&&i.storage.clear(),i.initSession(e),i.onDirectUserAction("rqd_js_init",{}),setTimeout(function(){return i.lifeCycle.emit("init")},0),i.initDelayTime=e.delay||1e3,i.cycleTask(i.initDelayTime)),i}};"object"==n(0)(t)&&void 0!==e?e.exports=r():void 0===(r="function"==typeof(r=r)?r.call(t,n,t,e):r)||(e.exports=r)},function(e,t,n){var s=n(9),f=n(1),i={};e.exports.transferToTaskMethod=function(e,n){i[n]=e[n],e[n]=function(e,t){e.SkipTask?i[n].call(this,e,t):this._addTask(n,e,t)}},e.exports.init=function(c){function t(e){var t={id:e.id,Bucket:e.Bucket,Region:e.Region,Key:e.Key,FilePath:e.FilePath,state:e.state,loaded:e.loaded,size:e.size,speed:e.speed,percent:e.percent,hashPercent:e.hashPercent,error:e.error};return e.FilePath&&(t.FilePath=e.FilePath),e._custom&&(t._custom=e._custom),t}function u(){if(!(d.length<=c.options.UploadQueueSize)){for(var e=0;e<o&&e<d.length&&d.length>c.options.UploadQueueSize;){var t="waiting"===d[e].state||"checking"===d[e].state||"uploading"===d[e].state;d[e]&&t?e++:(p[d[e].id]&&delete p[d[e].id],d.splice(e,1),o--)}h()}}function l(){if(!(a>=c.options.FileParallelLimit)){for(;d[o]&&"waiting"!==d[o].state;)o++;var n,e;o>=d.length||(n=d[o],o++,a++,n.state="checking",n.params.onTaskStart&&n.params.onTaskStart(t(n)),n.params.UploadData||(n.params.UploadData={}),e=f.formatParams(n.api,n.params),i[n.api].call(c,e,function(e,t){c._isRunningTask(n.id)&&("checking"!==n.state&&"uploading"!==n.state||(n.state=e?"error":"success",e&&(n.error=e),a--,h(),l(),n.callback&&n.callback(e,t),"success"===n.state&&(n.params&&(delete n.params.UploadData,delete n.params.Body,delete n.params),delete n.callback)),u())}),h(),setTimeout(l))}}function n(e,t){var n=p[e];if(n){var r=n&&"waiting"===n.state,o=n&&("checking"===n.state||"uploading"===n.state);if("canceled"===t&&"canceled"!==n.state||"paused"===t&&r||"paused"===t&&o){if("paused"===t&&n.params.Body&&"function"==typeof n.params.Body.pipe)return;n.state=t,c.emit("inner-kill-task",{TaskId:e,toState:t});try{var i=n&&n.params&&n.params.UploadData.UploadId}catch(e){}"canceled"===t&&i&&s.removeUsing(i),h(),o&&(a--,l()),"canceled"===t&&(n.params&&(delete n.params.UploadData,delete n.params.Body,delete n.params),delete n.callback)}u()}}var e,r,d=[],p={},a=0,o=0,h=(r=function(){e=0,c.emit("task-list-update",{list:f.map(d,t)}),c.emit("list-update",{list:f.map(d,t)})},function(){e=e||setTimeout(r)});c._addTasks=function(e){f.each(e,function(e){c._addTask(e.api,e.params,e.callback,!0)}),h()},c._addTask=function(e,t,n,r){t=f.formatParams(e,t);var o=f.uuid();t.TaskId=o,t.onTaskReady&&t.onTaskReady(o),t.TaskReady&&t.TaskReady(o);var i={params:t,callback:n,api:e,index:d.length,id:o,Bucket:t.Bucket,Region:t.Region,Key:t.Key,FilePath:t.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null,_custom:t._custom},a=t.onHashProgress;t.onHashProgress=function(e){c._isRunningTask(i.id)&&(i.hashPercent=e.percent,a&&a(e),h())};var s=t.onProgress;return t.onProgress=function(e){c._isRunningTask(i.id)&&("checking"===i.state&&(i.state="uploading"),i.loaded=e.loaded,i.speed=e.speed,i.percent=e.percent,s&&s(e),h())},f.getFileSize(e,t,function(e,t){return e?n(f.error(e)):(p[o]=i,d.push(i),i.size=t,r||h(),l(),void u())}),o},c._isRunningTask=function(e){e=p[e];return!(!e||"checking"!==e.state&&"uploading"!==e.state)},c.getTaskList=function(){return f.map(d,t)},c.cancelTask=function(e){n(e,"canceled")},c.pauseTask=function(e){n(e,"paused")},c.restartTask=function(e){e=p[e];!e||"paused"!==e.state&&"error"!==e.state||(e.state="waiting",h(),o=Math.min(o,e.index),l())},c.isUploadRunning=function(){return a||o<d.length}}},function(e,t,n){var c=n(0),m=n(27),C=n(1);function i(t){var n={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},r={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},e=(e=(t&&t.AccessControlList||{}).Grant)&&(C.isArray(e)?e:[e]),o={READ:0,WRITE:0,FULL_CONTROL:0};return e&&e.length&&C.each(e,function(e){"qcs::cam::anyone:anyone"===e.Grantee.ID||"http://cam.qcloud.com/groups/global/AllUsers"===e.Grantee.URI?o[e.Permission]=1:e.Grantee.ID!==t.Owner.ID&&n[r[e.Permission]].push('id="'+e.Grantee.ID+'"')}),o.FULL_CONTROL||o.WRITE&&o.READ?n.ACL="public-read-write":o.READ?n.ACL="public-read":n.ACL="private",C.each(r,function(e){n[e]=a(n[e].join(","))}),n}function a(e){for(var t,n=e.split(","),r={},o=0;o<n.length;)r[t=n[o].trim()]?n.splice(o,1):(r[t]=!0,n[o]=t,o++);return n.join(",")}function g(e){var t=e.region||"",n=e.bucket||"",r=n.substr(0,n.lastIndexOf("-")),o=n.substr(n.lastIndexOf("-")+1),i=e.domain,a=e.object;"function"==typeof i&&(i=i({Bucket:n,Region:t})),["http","https"].includes(e.protocol)&&(e.protocol=e.protocol+":");var s=e.protocol||(C.isBrowser&&"object"===("undefined"==typeof location?"undefined":c(location))&&"http:"===location.protocol?"http:":"https:");i||(i=-1<["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(t)?"{Region}.myqcloud.com":"cos.{Region}.myqcloud.com",e.ForcePathStyle||(i="{Bucket}."+i));i=(i=i.replace(/\{\{AppId\}\}/gi,o).replace(/\{\{Bucket\}\}/gi,r).replace(/\{\{Region\}\}/gi,t).replace(/\{\{.*?\}\}/gi,"")).replace(/\{AppId\}/gi,o).replace(/\{BucketName\}/gi,r).replace(/\{Bucket\}/gi,n).replace(/\{Region\}/gi,t).replace(/\{.*?\}/gi,""),i="/"===(i=!/^[a-zA-Z]+:\/\//.test(i)?s+"//"+i:i).slice(-1)?i.slice(0,-1):i;return e.ForcePathStyle&&(i+="/"+n),i+="/",a&&(i+=C.camSafeUrlEncode(a).replace(/%2F/g,"/")),i=e.isLocation?i.replace(/^https?:\/\//,""):i}function o(e){if(!e.Bucket||!e.Region)return"";var t=(void 0===e.UseAccelerate?this.options:e).UseAccelerate,e=(e.Url||g({ForcePathStyle:this.options.ForcePathStyle,protocol:this.options.Protocol,domain:this.options.Domain,bucket:e.Bucket,region:t?"accelerate":e.Region})).replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1");return new RegExp("^([a-z\\d-]+-\\d+\\.)?(cos|cosv6|ci|pic)\\.([a-z\\d-]+)\\.myqcloud\\.com$").test(e)?e:""}function l(t,n){var r=C.clone(t.Headers),o="";C.each(r,function(e,t){(""===e||-1<["content-type","cache-control","expires"].indexOf(t.toLowerCase()))&&delete r[t],"host"===t.toLowerCase()&&(o=e)});var i=!1!==t.ForceSignHost;!o&&t.SignHost&&i&&(r.Host=t.SignHost);function a(e,t){c||(c=!0,t&&t.XCosSecurityToken&&!t.SecurityToken&&((t=C.clone(t)).SecurityToken=t.XCosSecurityToken,delete t.XCosSecurityToken),n&&n(e,t))}var e,s,c=!1,u=this,l=t.Bucket||"",d=t.Region||"",p=t.Key||"",h="/"+(p=u.options.ForcePathStyle&&l?l+"/"+p:p),f={},m=t.Scope;m||(e=t.Action||"",s=t.ResourceKey||t.Key||"",m=t.Scope||[{action:e,bucket:l,region:d,prefix:s}]);var g=C.md5(JSON.stringify(m));u._StsCache=u._StsCache||[],function(){for(var e=u._StsCache.length-1;0<=e;e--){var t=u._StsCache[e],n=Math.round(C.getSkewTime(u.options.SystemClockOffset)/1e3)+30;if(t.StartTime&&n<t.StartTime||n>=t.ExpiredTime)u._StsCache.splice(e,1);else if(!t.ScopeLimit||t.ScopeLimit&&t.ScopeKey===g){f=t;break}}}();function y(){var e="";f.StartTime&&t.Expires?e=f.StartTime+";"+(f.StartTime+ +t.Expires):f.StartTime&&f.ExpiredTime&&(e=f.StartTime+";"+f.ExpiredTime),e={Authorization:C.getAuth({SecretId:f.TmpSecretId,SecretKey:f.TmpSecretKey,Method:t.Method,Pathname:h,Query:t.Query,Headers:r,Expires:t.Expires,UseRawKey:u.options.UseRawKey,SystemClockOffset:u.options.SystemClockOffset,KeyTime:e,ForceSignHost:i}),SecurityToken:f.SecurityToken||f.XCosSecurityToken||"",Token:f.Token||"",ClientIP:f.ClientIP||"",ClientUA:f.ClientUA||""},a(null,e)}function v(e){if(e.Authorization){var t=!1,n=e.Authorization;if(n)if(-1<n.indexOf(" "))t=!1;else if(-1<n.indexOf("q-sign-algorithm=")&&-1<n.indexOf("q-ak=")&&-1<n.indexOf("q-sign-time=")&&-1<n.indexOf("q-key-time=")&&-1<n.indexOf("q-url-param-list="))t=!0;else try{-1<(n=atob(n)).indexOf("a=")&&-1<n.indexOf("k=")&&-1<n.indexOf("t=")&&-1<n.indexOf("r=")&&-1<n.indexOf("b=")&&(t=!0)}catch(e){}if(!t)return C.error(new Error("getAuthorization callback params format error"))}else{if(!e.TmpSecretId)return C.error(new Error('getAuthorization callback params missing "TmpSecretId"'));if(!e.TmpSecretKey)return C.error(new Error('getAuthorization callback params missing "TmpSecretKey"'));if(!e.SecurityToken&&!e.XCosSecurityToken)return C.error(new Error('getAuthorization callback params missing "SecurityToken"'));if(!e.ExpiredTime)return C.error(new Error('getAuthorization callback params missing "ExpiredTime"'));if(e.ExpiredTime&&10!==e.ExpiredTime.toString().length)return C.error(new Error('getAuthorization callback params "ExpiredTime" should be 10 digits'));if(e.StartTime&&10!==e.StartTime.toString().length)return C.error(new Error('getAuthorization callback params "StartTime" should be 10 StartTime'))}return!1}if(f.ExpiredTime&&60<f.ExpiredTime-C.getSkewTime(u.options.SystemClockOffset)/1e3)y();else if(u.options.getAuthorization)u.options.getAuthorization.call(u,{Bucket:l,Region:d,Method:t.Method,Key:p,Pathname:h,Query:t.Query,Headers:r,Scope:m,SystemClockOffset:u.options.SystemClockOffset,ForceSignHost:i},function(e){var t=v(e="string"==typeof e?{Authorization:e}:e);if(t)return a(t);e.Authorization?a(null,e):((f=e||{}).Scope=m,f.ScopeKey=g,u._StsCache.push(f),y())});else{if(!u.options.getSTS)return p={Authorization:C.getAuth({SecretId:t.SecretId||u.options.SecretId,SecretKey:t.SecretKey||u.options.SecretKey,Method:t.Method,Pathname:h,Query:t.Query,Headers:r,Expires:t.Expires,UseRawKey:u.options.UseRawKey,SystemClockOffset:u.options.SystemClockOffset,ForceSignHost:i}),SecurityToken:u.options.SecurityToken||u.options.XCosSecurityToken},a(null,p),p;u.options.getSTS.call(u,{Bucket:l,Region:d},function(e){(f=e||{}).Scope=m,f.ScopeKey=g,f.TmpSecretId||(f.TmpSecretId=f.SecretId),f.TmpSecretKey||(f.TmpSecretKey=f.SecretKey);e=v(f);if(e)return a(e);u._StsCache.push(f),y()})}return""}function d(i,a){var s=this;i.headers||(i.headers={}),i.qs||(i.qs={}),i.VersionId&&(i.qs.versionId=i.VersionId),i.qs=C.clearKey(i.qs),i.headers&&(i.headers=C.clearKey(i.headers)),i.qs&&(i.qs=C.clearKey(i.qs));var e=C.clone(i.qs);i.action&&(e[i.action]="");var t=i.url||i.Url,c=i.SignHost||o.call(this,{Bucket:i.Bucket,Region:i.Region,Url:t}),u=i.tracker;!function n(r){var o=s.options.SystemClockOffset;u&&u.setParams({signStartTime:(new Date).getTime(),retryTimes:r-1}),l.call(s,{Bucket:i.Bucket||"",Region:i.Region||"",Method:i.method,Key:i.Key,Query:e,Headers:i.headers,SignHost:c,Action:i.Action,ResourceKey:i.ResourceKey,Scope:i.Scope,ForceSignHost:s.options.ForceSignHost},function(e,t){e?a(e):(u&&u.setParams({signEndTime:(new Date).getTime(),httpStartTime:(new Date).getTime()}),i.AuthData=t,function(t,c){var u=this,l=t.TaskId;{var e,n,r,o,d,p,i,a,s,h,f;l&&!u._isRunningTask(l)||(e=t.Bucket,n=t.Region,r=t.Key,a=t.method||"GET",o=t.Url||t.url,s=t.body,d=t.rawBody,u.options.UseAccelerate&&(n="accelerate"),o=o||g({ForcePathStyle:u.options.ForcePathStyle,protocol:u.options.Protocol,domain:u.options.Domain,bucket:e,region:n,object:r}),t.action&&(o=o+"?"+(C.isIOS_QQ?"".concat(t.action,"="):t.action)),t.qsStr&&(o=-1<o.indexOf("?")?o+"&"+t.qsStr:o+"?"+t.qsStr),p={method:a,url:o,headers:t.headers,qs:t.qs,body:s},a="x-cos-security-token",C.isCIHost(o)&&(a="x-ci-security-token"),p.headers.Authorization=t.AuthData.Authorization,t.AuthData.Token&&(p.headers.token=t.AuthData.Token),t.AuthData.ClientIP&&(p.headers.clientIP=t.AuthData.ClientIP),t.AuthData.ClientUA&&(p.headers.clientUA=t.AuthData.ClientUA),t.AuthData.SecurityToken&&(p.headers[a]=t.AuthData.SecurityToken),p.headers&&(p.headers=C.clearKey(p.headers)),p=C.clearKey(p),t.onProgress&&"function"==typeof t.onProgress&&(i=s&&(s.size||s.length)||0,p.onProgress=function(e){l&&!u._isRunningTask(l)||(e=e?e.loaded:0,t.onProgress({loaded:e,total:i}))}),t.onDownloadProgress&&(p.onDownloadProgress=t.onDownloadProgress),t.DataType&&(p.dataType=t.DataType),this.options.Timeout&&(p.timeout=this.options.Timeout),u.options.ForcePathStyle&&(p.pathStyle=u.options.ForcePathStyle),u.emit("before-send",p),a=p.url.includes("accelerate."),s=p.qs?Object.keys(p.qs).map(function(e){return"".concat(e,"=").concat(p.qs[e])}).join("&"):"",s=s?p.url+"?"+s:p.url,t.tracker&&t.tracker.setParams({reqUrl:s,accelerate:a?"Y":"N"}),t.tracker&&t.tracker.parent&&t.tracker.parent.setParams({reqUrl:s,accelerate:a?"Y":"N"}),h=(u.options.Request||m)(p,function(e){if(!e||"abort"!==e.error){var t={options:p,error:e&&e.error,statusCode:e&&e.statusCode||0,statusMessage:e&&e.statusMessage||"",headers:e&&e.headers||{},body:e&&e.body};u.emit("after-receive",t);function n(e,t){var n;l&&u.off("inner-kill-task",f),r||(r=!0,n={},a.statusCode&&(n.statusCode=a.statusCode),a.headers&&(n.headers=a.headers),e?(e=C.extend(e||{},n),c(e,null)):(t=C.extend(t||{},n),c(null,t)),h=null)}var r,o=t.error,i=t.body,a={statusCode:t.statusCode,statusMessage:t.statusMessage,headers:t.headers};if(o)return n(C.error(o));var s,t=a.statusCode,o=2===Math.floor(t/100);if(d&&o)return n(null,{body:i});try{s=i&&-1<i.indexOf("<")&&-1<i.indexOf(">")&&C.xml2json(i)||{}}catch(e){s={}}i=s&&s.Error;o?n(null,s):i?n(C.error(new Error(i.Message),{code:i.Code,error:i})):t&&n(C.error(new Error(a.statusMessage),{code:""+t}))}}),f=function e(t){t.TaskId===l&&(h&&h.abort&&h.abort(),u.off("inner-kill-task",e))},l&&u.on("inner-kill-task",f))}}.call(s,i,function(e,t){u&&u.setParams({httpEndTime:(new Date).getTime()}),e&&r<2&&(o!==s.options.SystemClockOffset||function(e){var t=!1,n=!1,r=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var o=e.error.Code,i=e.error.Message;("RequestTimeTooSkewed"===o||"AccessDenied"===o&&"Request has expired"===i)&&(n=!0)}catch(e){}return e&&(n&&r?(r=Date.parse(r),this.options.CorrectClockSkew&&3e4<=Math.abs(C.getSkewTime(this.options.SystemClockOffset)-r)&&(this.options.SystemClockOffset=r-Date.now(),t=!0)):5===Math.floor(e.statusCode/100)&&(t=!0)),t}.call(s,e))?(i.headers&&(delete i.headers.Authorization,delete i.headers.token,delete i.headers.clientIP,delete i.headers.clientUA,i.headers["x-cos-security-token"]&&delete i.headers["x-cos-security-token"],i.headers["x-ci-security-token"]&&delete i.headers["x-ci-security-token"]),n(r+1)):a(e,t)}))})}(1)}var r={getService:function(e,r){"function"==typeof e&&(r=e,e={});var t=this.options.Protocol||(C.isBrowser&&"object"===("undefined"==typeof location?"undefined":c(location))&&"http:"===location.protocol?"http:":"https:"),n=this.options.ServiceDomain,o=e.AppId||this.options.appId,i=e.Region;n?(n=n.replace(/\{\{AppId\}\}/gi,o||"").replace(/\{\{Region\}\}/gi,i||"").replace(/\{\{.*?\}\}/gi,""),"/"===(n=!/^[a-zA-Z]+:\/\//.test(n)?t+"//"+n:n).slice(-1)&&(n=n.slice(0,-1))):n=i?t+"//cos."+i+".myqcloud.com":t+"//service.cos.myqcloud.com";t="",i=i?"cos."+i+".myqcloud.com":"service.cos.myqcloud.com";i===n.replace(/^https?:\/\/([^/]+)(\/.*)?$/,"$1")&&(t=i),d.call(this,{Action:"name/cos:GetService",url:n,method:"GET",headers:e.Headers,SignHost:t},function(e,t){if(e)return r(e);var n=t&&t.ListAllMyBucketsResult&&t.ListAllMyBucketsResult.Buckets&&t.ListAllMyBucketsResult.Buckets.Bucket||[],n=C.isArray(n)?n:[n],e=t&&t.ListAllMyBucketsResult&&t.ListAllMyBucketsResult.Owner||{};r(null,{Buckets:n,Owner:e,statusCode:t.statusCode,headers:t.headers})})},putBucket:function(n,r){var e,o=this,t="";n.BucketAZConfig&&(e={BucketAZConfig:n.BucketAZConfig},t=C.json2xml({CreateBucketConfiguration:e})),d.call(this,{Action:"name/cos:PutBucket",method:"PUT",Bucket:n.Bucket,Region:n.Region,headers:n.Headers,body:t},function(e,t){if(e)return r(e);e=g({protocol:o.options.Protocol,domain:o.options.Domain,bucket:n.Bucket,region:n.Region,isLocation:!0});r(null,{Location:e,statusCode:t.statusCode,headers:t.headers})})},headBucket:function(e,t){d.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD"},t)},getBucket:function(e,o){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t.marker=e.Marker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,d.call(this,{Action:"name/cos:GetBucket",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t},function(e,t){if(e)return o(e);var n=t.ListBucketResult||{},r=n.Contents||[],e=n.CommonPrefixes||[],r=C.isArray(r)?r:[r],e=C.isArray(e)?e:[e],n=C.clone(n);C.extend(n,{Contents:r,CommonPrefixes:e,statusCode:t.statusCode,headers:t.headers}),o(null,n)})},deleteBucket:function(e,n){d.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketAcl:function(e,n){var t,r,o=e.Headers,i="";e.AccessControlPolicy&&(r=(t=C.clone(e.AccessControlPolicy||{})).Grants||t.Grant,r=C.isArray(r)?r:[r],delete t.Grant,delete t.Grants,t.AccessControlList={Grant:r},i=C.json2xml({AccessControlPolicy:t}),o["Content-Type"]="application/xml",o["Content-MD5"]=C.binaryBase64(C.md5(i))),C.each(o,function(e,t){0===t.indexOf("x-cos-grant-")&&(o[t]=a(o[t]))}),d.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:o,action:"acl",body:i},function(e,t){return e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketAcl:function(e,o){d.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl"},function(e,t){if(e)return o(e);var n=t.AccessControlPolicy||{},r=n.Owner||{},e=n.AccessControlList.Grant||[],e=C.isArray(e)?e:[e],n=i(n);t.headers&&t.headers["x-cos-acl"]&&(n.ACL=t.headers["x-cos-acl"]),n=C.extend(n,{Owner:r,Grants:e,statusCode:t.statusCode,headers:t.headers}),o(null,n)})},putBucketCors:function(e,n){var t=(e.CORSConfiguration||{}).CORSRules||e.CORSRules||[],t=C.clone(C.isArray(t)?t:[t]);C.each(t,function(r){C.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(e){var t=e+"s",n=r[t]||r[e]||[];delete r[t],r[e]=C.isArray(n)?n:[n]})});var r={CORSRule:t};e.ResponseVary&&(r.ResponseVary=e.ResponseVary);t=C.json2xml({CORSConfiguration:r}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"cors",headers:r},function(e,t){return e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketCors:function(e,r){d.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(e,t){var n;e?404===e.statusCode&&e.error&&"NoSuchCORSConfiguration"===e.error.Code?(n={CORSRules:[],statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):r(e):(e=(n=t.CORSConfiguration||{}).CORSRules||n.CORSRule||[],e=C.clone(C.isArray(e)?e:[e]),n=n.ResponseVary,C.each(e,function(r){C.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],function(e){var t=e+"s",n=r[t]||r[e]||[];delete r[e],r[t]=C.isArray(n)?n:[n]})}),r(null,{CORSRules:e,ResponseVary:n,statusCode:t.statusCode,headers:t.headers}))})},deleteBucketCors:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode||e.statusCode,headers:t.headers})})},getBucketLocation:function(e,t){d.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location"},t)},getBucketPolicy:function(e,r){d.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0},function(e,t){if(e)return e.statusCode&&403===e.statusCode?r(C.error(e,{ErrorStatus:"Access Denied"})):e.statusCode&&405===e.statusCode?r(C.error(e,{ErrorStatus:"Method Not Allowed"})):e.statusCode&&404===e.statusCode?r(C.error(e,{ErrorStatus:"Policy Not Found"})):r(e);var n={};try{n=JSON.parse(t.body)}catch(e){}r(null,{Policy:n,statusCode:t.statusCode,headers:t.headers})})},putBucketPolicy:function(e,n){var t=e.Policy;try{"string"==typeof t&&(t=JSON.parse(t))}catch(e){}if(!t||"string"==typeof t)return n(C.error(new Error("Policy format error")));var r=JSON.stringify(t);t.version||(t.version="2.0");t=e.Headers;t["Content-Type"]="application/json",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:r,headers:t},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},deleteBucketPolicy:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode||e.statusCode,headers:t.headers})})},putBucketTagging:function(e,n){var t=e.Tagging||{},r=t.TagSet||t.Tags||e.Tags||[],r=C.clone(C.isArray(r)?r:[r]),t=C.json2xml({Tagging:{TagSet:{Tag:r}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"tagging",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketTagging:function(e,r){d.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(e,t){if(e)404!==e.statusCode||!e.error||"Not Found"!==e.error&&"NoSuchTagSet"!==e.error.Code?r(e):(n={Tags:[],statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n));else{var n=[];try{n=t.Tagging.TagSet.Tag||[]}catch(e){}n=C.clone(C.isArray(n)?n:[n]),r(null,{Tags:n,statusCode:t.statusCode,headers:t.headers})}})},deleteBucketTagging:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketLifecycle:function(e,n){var t=(e.LifecycleConfiguration||{}).Rules||e.Rules||[],t=C.clone(t),r=C.json2xml({LifecycleConfiguration:{Rule:t}}),t=e.Headers;t["Content-Type"]="application/xml",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"lifecycle",headers:t},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketLifecycle:function(e,r){d.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(e,t){if(e)404===e.statusCode&&e.error&&"NoSuchLifecycleConfiguration"===e.error.Code?(n={Rules:[],statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):r(e);else{var n=[];try{n=t.LifecycleConfiguration.Rule||[]}catch(e){}n=C.clone(C.isArray(n)?n:[n]),r(null,{Rules:n,statusCode:t.statusCode,headers:t.headers})}})},deleteBucketLifecycle:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketVersioning:function(e,n){var t,r;e.VersioningConfiguration?(r=e.VersioningConfiguration||{},t=C.json2xml({VersioningConfiguration:r}),(r=e.Headers)["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"versioning",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})):n(C.error(new Error("missing param VersioningConfiguration")))},getBucketVersioning:function(e,n){d.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning"},function(e,t){e||(t.VersioningConfiguration||(t.VersioningConfiguration={})),n(e,t)})},putBucketReplication:function(e,n){var t=C.clone(e.ReplicationConfiguration),r=(r=(r=C.json2xml({ReplicationConfiguration:t})).replace(/<(\/?)Rules>/gi,"<$1Rule>")).replace(/<(\/?)Tags>/gi,"<$1Tag>"),t=e.Headers;t["Content-Type"]="application/xml",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"replication",headers:t},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketReplication:function(e,r){d.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(e,t){var n;e?404!==e.statusCode||!e.error||"Not Found"!==e.error&&"ReplicationConfigurationnotFoundError"!==e.error.Code?r(e):(n={ReplicationConfiguration:{Rules:[]},statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):(t.ReplicationConfiguration||(t.ReplicationConfiguration={}),t.ReplicationConfiguration.Rule&&(t.ReplicationConfiguration.Rules=C.makeArray(t.ReplicationConfiguration.Rule),delete t.ReplicationConfiguration.Rule),r(e,t))})},deleteBucketReplication:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketWebsite:function(e,n){var t,r;e.WebsiteConfiguration?(t=(r=C.clone(e.WebsiteConfiguration||{})).RoutingRules||r.RoutingRule||[],t=C.isArray(t)?t:[t],delete r.RoutingRule,delete r.RoutingRules,t.length&&(r.RoutingRules={RoutingRule:t}),t=C.json2xml({WebsiteConfiguration:r}),(r=e.Headers)["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketWebsite",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"website",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})):n(C.error(new Error("missing param WebsiteConfiguration")))},getBucketWebsite:function(e,r){d.call(this,{Action:"name/cos:GetBucketWebsite",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"website"},function(e,t){var n;e?404===e.statusCode&&"NoSuchWebsiteConfiguration"===e.error.Code?(n={WebsiteConfiguration:{},statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):r(e):((n=t.WebsiteConfiguration||{}).RoutingRules&&(e=C.clone(n.RoutingRules.RoutingRule||[]),e=C.makeArray(e),n.RoutingRules=e),r(null,{WebsiteConfiguration:n,statusCode:t.statusCode,headers:t.headers}))})},deleteBucketWebsite:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketWebsite",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"website"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketReferer:function(e,n){var t,r;e.RefererConfiguration?(t=(t=(r=C.clone(e.RefererConfiguration||{})).DomainList||{}).Domains||t.Domain||[],(t=C.isArray(t)?t:[t]).length&&(r.DomainList={Domain:t}),t=C.json2xml({RefererConfiguration:r}),(r=e.Headers)["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketReferer",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"referer",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})):n(C.error(new Error("missing param RefererConfiguration")))},getBucketReferer:function(e,r){d.call(this,{Action:"name/cos:GetBucketReferer",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"referer"},function(e,t){var n;e?404===e.statusCode&&"NoSuchRefererConfiguration"===e.error.Code?(n={WebsiteConfiguration:{},statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):r(e):((n=t.RefererConfiguration||{}).DomainList&&(e=C.makeArray(n.DomainList.Domain||[]),n.DomainList={Domains:e}),r(null,{RefererConfiguration:n,statusCode:t.statusCode,headers:t.headers}))})},putBucketDomain:function(e,n){var t=(e.DomainConfiguration||{}).DomainRule||e.DomainRule||[],t=C.clone(t),r=C.json2xml({DomainConfiguration:{DomainRule:t}}),t=e.Headers;t["Content-Type"]="application/xml",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:PutBucketDomain",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"domain",headers:t},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketDomain:function(e,r){d.call(this,{Action:"name/cos:GetBucketDomain",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(e,t){if(e)return r(e);var n=[];try{n=t.DomainConfiguration.DomainRule||[]}catch(e){}n=C.clone(C.isArray(n)?n:[n]),r(null,{DomainRule:n,statusCode:t.statusCode,headers:t.headers})})},deleteBucketDomain:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketDomain",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"domain"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketOrigin:function(e,n){var t=(e.OriginConfiguration||{}).OriginRule||e.OriginRule||[],t=C.clone(t),r=C.json2xml({OriginConfiguration:{OriginRule:t}}),t=e.Headers;t["Content-Type"]="application/xml",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:PutBucketOrigin",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"origin",headers:t},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketOrigin:function(e,r){d.call(this,{Action:"name/cos:GetBucketOrigin",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(e,t){if(e)return r(e);var n=[];try{n=t.OriginConfiguration.OriginRule||[]}catch(e){}n=C.clone(C.isArray(n)?n:[n]),r(null,{OriginRule:n,statusCode:t.statusCode,headers:t.headers})})},deleteBucketOrigin:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketOrigin",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"origin"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketLogging:function(e,n){var t=C.json2xml({BucketLoggingStatus:e.BucketLoggingStatus||""}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketLogging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"logging",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketLogging:function(e,n){d.call(this,{Action:"name/cos:GetBucketLogging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"logging"},function(e,t){return e?n(e):void n(null,{BucketLoggingStatus:t.BucketLoggingStatus,statusCode:t.statusCode,headers:t.headers})})},putBucketInventory:function(e,n){var t,r=C.clone(e.InventoryConfiguration);r.OptionalFields&&(t=r.OptionalFields||[],r.OptionalFields={Field:t}),r.Destination&&r.Destination.COSBucketDestination&&r.Destination.COSBucketDestination.Encryption&&(o=r.Destination.COSBucketDestination.Encryption,-1<Object.keys(o).indexOf("SSECOS")&&(o["SSE-COS"]=o.SSECOS,delete o.SSECOS));var o=C.json2xml({InventoryConfiguration:r}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(o)),d.call(this,{Action:"name/cos:PutBucketInventory",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:o,action:"inventory",qs:{id:e.Id},headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketInventory:function(e,r){d.call(this,{Action:"name/cos:GetBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(e,t){if(e)return r(e);var n,e=t.InventoryConfiguration;e&&e.OptionalFields&&e.OptionalFields.Field&&(n=e.OptionalFields.Field,C.isArray(n)||(n=[n]),e.OptionalFields=n),e.Destination&&e.Destination.COSBucketDestination&&e.Destination.COSBucketDestination.Encryption&&(n=e.Destination.COSBucketDestination.Encryption,-1<Object.keys(n).indexOf("SSE-COS")&&(n.SSECOS=n["SSE-COS"],delete n["SSE-COS"])),r(null,{InventoryConfiguration:e,statusCode:t.statusCode,headers:t.headers})})},listBucketInventory:function(e,r){d.call(this,{Action:"name/cos:ListBucketInventory",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{"continuation-token":e.ContinuationToken}},function(e,t){if(e)return r(e);var n=t.ListInventoryConfigurationResult,e=n.InventoryConfiguration||[],e=C.isArray(e)?e:[e];delete n.InventoryConfiguration,C.each(e,function(e){var t;e&&e.OptionalFields&&e.OptionalFields.Field&&(t=e.OptionalFields.Field,C.isArray(t)||(t=[t]),e.OptionalFields=t),e.Destination&&e.Destination.COSBucketDestination&&e.Destination.COSBucketDestination.Encryption&&(e=e.Destination.COSBucketDestination.Encryption,-1<Object.keys(e).indexOf("SSE-COS")&&(e.SSECOS=e["SSE-COS"],delete e["SSE-COS"]))}),n.InventoryConfigurations=e,C.extend(n,{statusCode:t.statusCode,headers:t.headers}),r(null,n)})},deleteBucketInventory:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketInventory",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"inventory",qs:{id:e.Id}},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},putBucketAccelerate:function(e,n){var t,r;e.AccelerateConfiguration?(r={AccelerateConfiguration:e.AccelerateConfiguration||{}},t=C.json2xml(r),(r={"Content-Type":"application/xml"})["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketAccelerate",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"accelerate",headers:r},function(e,t){return e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})):n(C.error(new Error("missing param AccelerateConfiguration")))},getBucketAccelerate:function(e,n){d.call(this,{Action:"name/cos:GetBucketAccelerate",method:"GET",Bucket:e.Bucket,Region:e.Region,action:"accelerate"},function(e,t){e||(t.AccelerateConfiguration||(t.AccelerateConfiguration={})),n(e,t)})},putBucketEncryption:function(e,n){var t=e.ServerSideEncryptionConfiguration||{},r=t.Rule||t.Rules||[],t=C.json2xml({ServerSideEncryptionConfiguration:{Rule:r}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutBucketEncryption",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:t,action:"encryption",headers:r},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getBucketEncryption:function(e,r){d.call(this,{Action:"name/cos:GetBucketEncryption",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(e,t){var n;e?404===e.statusCode&&"NoSuchEncryptionConfiguration"===e.code?(n={EncryptionConfiguration:{Rules:[]},statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n)):r(e):(n=C.makeArray(t.EncryptionConfiguration&&t.EncryptionConfiguration.Rule||[]),t.EncryptionConfiguration={Rules:n},r(e,t))})},deleteBucketEncryption:function(e,n){d.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"encryption"},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getObject:function(r,o){var e=r.Query||{},t=r.QueryString||"",i=C.throttleOnProgress.call(this,0,r.onProgress),n=r.tracker;n&&n.setParams({signStartTime:(new Date).getTime()}),e["response-content-type"]=r.ResponseContentType,e["response-content-language"]=r.ResponseContentLanguage,e["response-expires"]=r.ResponseExpires,e["response-cache-control"]=r.ResponseCacheControl,e["response-content-disposition"]=r.ResponseContentDisposition,e["response-content-encoding"]=r.ResponseContentEncoding,d.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:r.Bucket,Region:r.Region,Key:r.Key,VersionId:r.VersionId,DataType:r.DataType,headers:r.Headers,qs:e,qsStr:t,rawBody:!0,onDownloadProgress:i,tracker:n},function(e,t){if(i(null,!0),e){var n=e.statusCode;return r.Headers["If-Modified-Since"]&&n&&304===n?o(null,{NotModified:!0}):o(e)}o(null,{Body:t.body,ETag:C.attr(t.headers,"etag",""),statusCode:t.statusCode,headers:t.headers})})},headObject:function(r,o){d.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:r.Bucket,Region:r.Region,Key:r.Key,VersionId:r.VersionId,headers:r.Headers},function(e,t){if(e){var n=e.statusCode;return r.Headers["If-Modified-Since"]&&n&&304===n?o(null,{NotModified:!0,statusCode:n}):o(e)}t.ETag=C.attr(t.headers,"etag",""),o(null,t)})},listObjectVersions:function(e,o){var t={};t.prefix=e.Prefix||"",t.delimiter=e.Delimiter,t["key-marker"]=e.KeyMarker,t["version-id-marker"]=e.VersionIdMarker,t["max-keys"]=e.MaxKeys,t["encoding-type"]=e.EncodingType,d.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"versions"},function(e,t){if(e)return o(e);var n=t.ListVersionsResult||{},r=n.DeleteMarker||[],r=C.isArray(r)?r:[r],e=n.Version||[],e=C.isArray(e)?e:[e],n=C.clone(n);delete n.DeleteMarker,delete n.Version,C.extend(n,{DeleteMarkers:r,Versions:e,statusCode:t.statusCode,headers:t.headers}),o(null,n)})},putObject:function(n,r){var o=this,i=n.ContentLength,a=C.throttleOnProgress.call(o,i,n.onProgress),t=n.Headers;t["Cache-Control"]||t["cache-control"]||(t["Cache-Control"]=""),t["Content-Type"]||t["content-type"]||(t["Content-Type"]=n.Body&&n.Body.type||"");var e=n.UploadAddMetaMd5||o.options.UploadAddMetaMd5||o.options.UploadCheckContentMd5,s=n.tracker;e&&s&&s.setParams({md5StartTime:(new Date).getTime()}),C.getBodyMd5(e,n.Body,function(e){e&&(s&&s.setParams({md5EndTime:(new Date).getTime()}),o.options.UploadCheckContentMd5&&(t["Content-MD5"]=C.binaryBase64(e)),(n.UploadAddMetaMd5||o.options.UploadAddMetaMd5)&&(t["x-cos-meta-md5"]=e)),void 0!==n.ContentLength&&(t["Content-Length"]=n.ContentLength),a(null,!0),d.call(o,{Action:"name/cos:PutObject",TaskId:n.TaskId,method:"PUT",Bucket:n.Bucket,Region:n.Region,Key:n.Key,headers:n.Headers,qs:n.Query,body:n.Body,onProgress:a,tracker:s},function(e,t){if(e)return a(null,!0),r(e);a({loaded:i,total:i},!0);e=(e=g({ForcePathStyle:o.options.ForcePathStyle,protocol:o.options.Protocol,domain:o.options.Domain,bucket:n.Bucket,region:o.options.UseAccelerate?"accelerate":n.Region,object:n.Key})).substr(e.indexOf("://")+3);t.Location=e,t.ETag=C.attr(t.headers,"etag",""),r(null,t)})},n.onHashProgress)},deleteObject:function(e,r){d.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId,action:e.Recursive?"recursive":""},function(e,t){if(e){var n=e.statusCode;return n&&404===n?r(null,{BucketNotFound:!0,statusCode:n}):r(e)}r(null,{statusCode:t.statusCode,headers:t.headers})})},getObjectAcl:function(e,o){var t={};e.VersionId&&(t.versionId=e.VersionId),d.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t,action:"acl"},function(e,t){if(e)return o(e);var n=t.AccessControlPolicy||{},r=n.Owner||{},e=n.AccessControlList&&n.AccessControlList.Grant||[],e=C.isArray(e)?e:[e],n=i(n);delete n.GrantWrite,t.headers&&t.headers["x-cos-acl"]&&(n.ACL=t.headers["x-cos-acl"]),n=C.extend(n,{Owner:r,Grants:e,statusCode:t.statusCode,headers:t.headers}),o(null,n)})},putObjectAcl:function(e,n){var t,r,o=e.Headers,i="";e.AccessControlPolicy&&(r=(t=C.clone(e.AccessControlPolicy||{})).Grants||t.Grant,r=C.isArray(r)?r:[r],delete t.Grant,delete t.Grants,t.AccessControlList={Grant:r},i=C.json2xml({AccessControlPolicy:t}),o["Content-Type"]="application/xml",o["Content-MD5"]=C.binaryBase64(C.md5(i))),C.each(o,function(e,t){0===t.indexOf("x-cos-grant-")&&(o[t]=a(o[t]))}),d.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:o,body:i},function(e,t){return e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},optionsObject:function(e,n){var t=e.Headers;t.Origin=e.Origin,t["Access-Control-Request-Method"]=e.AccessControlRequestMethod,t["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,d.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:t},function(e,t){if(e)return e.statusCode&&403===e.statusCode?n(null,{OptionsForbidden:!0,statusCode:e.statusCode}):n(e);e=t.headers||{};n(null,{AccessControlAllowOrigin:e["access-control-allow-origin"],AccessControlAllowMethods:e["access-control-allow-methods"],AccessControlAllowHeaders:e["access-control-allow-headers"],AccessControlExposeHeaders:e["access-control-expose-headers"],AccessControlMaxAge:e["access-control-max-age"],statusCode:t.statusCode,headers:t.headers})})},putObjectCopy:function(r,o){var i=this,e=r.Headers;e["Cache-Control"]||e["cache-control"]||(e["Cache-Control"]="");var t=r.CopySource||"",n=C.getSourceParams.call(this,t);n?(e=n.Bucket,t=n.Region,n=decodeURIComponent(n.Key),d.call(this,{Scope:[{action:"name/cos:GetObject",bucket:e,region:t,prefix:n},{action:"name/cos:PutObject",bucket:r.Bucket,region:r.Region,prefix:r.Key}],method:"PUT",Bucket:r.Bucket,Region:r.Region,Key:r.Key,VersionId:r.VersionId,headers:r.Headers},function(e,t){if(e)return o(e);var n=C.clone(t.CopyObjectResult||{}),e=g({ForcePathStyle:i.options.ForcePathStyle,protocol:i.options.Protocol,domain:i.options.Domain,bucket:r.Bucket,region:r.Region,object:r.Key,isLocation:!0});C.extend(n,{Location:e,statusCode:t.statusCode,headers:t.headers}),o(null,n)})):o(C.error(new Error("CopySource format error")))},deleteMultipleObject:function(t,o){var e=t.Objects||[],n=t.Quiet,e=C.isArray(e)?e:[e],r=C.json2xml({Delete:{Object:e,Quiet:n||!1}}),n=t.Headers;n["Content-Type"]="application/xml",n["Content-MD5"]=C.binaryBase64(C.md5(r));e=C.map(e,function(e){return{action:"name/cos:DeleteObject",bucket:t.Bucket,region:t.Region,prefix:e.Key}});d.call(this,{Scope:e,method:"POST",Bucket:t.Bucket,Region:t.Region,body:r,action:"delete",headers:n},function(e,t){if(e)return o(e);var n=t.DeleteResult||{},r=n.Deleted||[],e=n.Error||[],r=C.isArray(r)?r:[r],e=C.isArray(e)?e:[e],n=C.clone(n);C.extend(n,{Error:e,Deleted:r,statusCode:t.statusCode,headers:t.headers}),o(null,n)})},restoreObject:function(e,t){var n,r=e.Headers;e.RestoreRequest?(n=e.RestoreRequest||{},n=C.json2xml({RestoreRequest:n}),r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(n)),d.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:n,action:"restore",headers:r},t)):t(C.error(new Error("missing param RestoreRequest")))},putObjectTagging:function(e,n){var t=e.Tagging||{},r=t.TagSet||t.Tags||e.Tags||[],r=C.clone(C.isArray(r)?r:[r]),t=C.json2xml({Tagging:{TagSet:{Tag:r}}}),r=e.Headers;r["Content-Type"]="application/xml",r["Content-MD5"]=C.binaryBase64(C.md5(t)),d.call(this,{Action:"name/cos:PutObjectTagging",method:"PUT",Bucket:e.Bucket,Key:e.Key,Region:e.Region,body:t,action:"tagging",headers:r,VersionId:e.VersionId},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},getObjectTagging:function(e,r){d.call(this,{Action:"name/cos:GetObjectTagging",method:"GET",Key:e.Key,Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(e,t){if(e)404!==e.statusCode||!e.error||"Not Found"!==e.error&&"NoSuchTagSet"!==e.error.Code?r(e):(n={Tags:[],statusCode:e.statusCode},e.headers&&(n.headers=e.headers),r(null,n));else{var n=[];try{n=t.Tagging.TagSet.Tag||[]}catch(e){}n=C.clone(C.isArray(n)?n:[n]),r(null,{Tags:n,statusCode:t.statusCode,headers:t.headers})}})},deleteObjectTagging:function(e,n){d.call(this,{Action:"name/cos:DeleteObjectTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"tagging",VersionId:e.VersionId},function(e,t){return e&&204===e.statusCode?n(null,{statusCode:e.statusCode}):e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},selectObjectContent:function(e,n){if(!e.SelectType)return n(C.error(new Error("missing param SelectType")));var t=e.SelectRequest||{},r=C.json2xml({SelectRequest:t}),t=e.Headers;t["Content-Type"]="application/xml",t["Content-MD5"]=C.binaryBase64(C.md5(r)),d.call(this,{Action:"name/cos:GetObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"select",qs:{"select-type":e.SelectType},VersionId:e.VersionId,body:r,DataType:"arraybuffer",rawBody:!0},function(e,t){if(e&&204===e.statusCode)return n(null,{statusCode:e.statusCode});if(e)return n(e);e=C.parseSelectPayload(t.body);n(null,{statusCode:t.statusCode,headers:t.headers,Body:e.body,Payload:e.payload})})},appendObject:function(e,n){var t=e.Headers;t["Cache-Control"]||t["cache-control"]||(t["Cache-Control"]=""),t["Content-Type"]||t["content-type"]||(t["Content-Type"]=e.Body&&e.Body.type||""),d.call(this,{Action:"name/cos:AppendObject",method:"POST",Bucket:e.Bucket,Region:e.Region,action:"append",Key:e.Key,body:e.Body,qs:{position:e.Position},headers:e.Headers},function(e,t){return e?n(e):void n(null,t)})},uploadPartCopy:function(e,n){var t,r=e.CopySource||"",o=C.getSourceParams.call(this,r);o?(t=o.Bucket,r=o.Region,o=decodeURIComponent(o.Key),d.call(this,{Scope:[{action:"name/cos:GetObject",bucket:t,region:r,prefix:o},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers},function(e,t){if(e)return n(e);e=C.clone(t.CopyPartResult||{});C.extend(e,{statusCode:t.statusCode,headers:t.headers}),n(null,e)})):n(C.error(new Error("CopySource format error")))},multipartInit:function(t,n){var r=this,e=t.Headers,o=t.tracker;e["Cache-Control"]||e["cache-control"]||(e["Cache-Control"]=""),e["Content-Type"]||e["content-type"]||(e["Content-Type"]=t.Body&&t.Body.type||"");var i=t.Body&&(t.UploadAddMetaMd5||r.options.UploadAddMetaMd5);i&&o&&o.setParams({md5StartTime:(new Date).getTime()}),C.getBodyMd5(i,t.Body,function(e){e&&(t.Headers["x-cos-meta-md5"]=e),i&&o&&o.setParams({md5EndTime:(new Date).getTime()}),d.call(r,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:t.Bucket,Region:t.Region,Key:t.Key,action:"uploads",headers:t.Headers,qs:t.Query,tracker:o},function(e,t){return e?(o&&o.parent&&o.parent.setParams({errorNode:"multipartInit"}),n(e)):(t=C.clone(t||{}))&&t.InitiateMultipartUploadResult?n(null,C.extend(t.InitiateMultipartUploadResult,{statusCode:t.statusCode,headers:t.headers})):void n(null,t)})},t.onHashProgress)},multipartUpload:function(r,o){var i=this;C.getFileSize("multipartUpload",r,function(){var n=r.tracker,t=i.options.UploadCheckContentMd5;t&&n&&n.setParams({md5StartTime:(new Date).getTime()}),C.getBodyMd5(t,r.Body,function(e){e&&(r.Headers["Content-MD5"]=C.binaryBase64(e)),t&&n&&n.setParams({md5EndTime:(new Date).getTime()}),n&&n.setParams({partNumber:r.PartNumber}),d.call(i,{Action:"name/cos:UploadPart",TaskId:r.TaskId,method:"PUT",Bucket:r.Bucket,Region:r.Region,Key:r.Key,qs:{partNumber:r.PartNumber,uploadId:r.UploadId},headers:r.Headers,onProgress:r.onProgress,body:r.Body||null,tracker:n},function(e,t){return e?(n&&n.parent&&n.parent.setParams({errorNode:"multipartUpload"}),o(e)):void o(null,{ETag:C.attr(t.headers,"etag",""),statusCode:t.statusCode,headers:t.headers})})})})},multipartComplete:function(r,o){for(var i=this,e=r.UploadId,t=r.Parts,a=r.tracker,n=0,s=t.length;n<s;n++)t[n].ETag&&0===t[n].ETag.indexOf('"')||(t[n].ETag='"'+t[n].ETag+'"');var c=(c=C.json2xml({CompleteMultipartUpload:{Part:t}})).replace(/\n\s*/g,""),u=r.Headers;u["Content-Type"]="application/xml",u["Content-MD5"]=C.binaryBase64(C.md5(c)),d.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:r.Bucket,Region:r.Region,Key:r.Key,qs:{uploadId:e},body:c,headers:u,tracker:a},function(e,t){if(e)return a&&a.parent&&a.parent.setParams({errorNode:"multipartComplete"}),o(e);var n=g({ForcePathStyle:i.options.ForcePathStyle,protocol:i.options.Protocol,domain:i.options.Domain,bucket:r.Bucket,region:r.Region,object:r.Key,isLocation:!0}),e=t.CompleteMultipartUploadResult||{};e.ProcessResults&&e&&e.ProcessResults&&(e.UploadResult={OriginalInfo:{Key:e.Key,Location:n,ETag:e.ETag,ImageInfo:e.ImageInfo},ProcessResults:e.ProcessResults},delete e.ImageInfo,delete e.ProcessResults);t=C.extend(e,{Location:n,statusCode:t.statusCode,headers:t.headers});o(null,t)})},multipartList:function(e,r){(t={}).delimiter=e.Delimiter,t["encoding-type"]=e.EncodingType,t.prefix=e.Prefix||"",t["max-uploads"]=e.MaxUploads,t["key-marker"]=e.KeyMarker,t["upload-id-marker"]=e.UploadIdMarker;var t=C.clearKey(t),o=e.tracker;o&&o.setParams({signStartTime:(new Date).getTime()}),d.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:t.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:t,action:"uploads",tracker:o},function(e,t){if(e)return o&&o.parent&&o.parent.setParams({errorNode:"multipartList"}),r(e);t&&t.ListMultipartUploadsResult&&(n=t.ListMultipartUploadsResult.Upload||[],n=C.isArray(n)?n:[n],t.ListMultipartUploadsResult.Upload=n);var n=C.clone(t.ListMultipartUploadsResult||{});C.extend(n,{statusCode:t.statusCode,headers:t.headers}),r(null,n)})},multipartListPart:function(e,r){var t={},o=e.tracker;t.uploadId=e.UploadId,t["encoding-type"]=e.EncodingType,t["max-parts"]=e.MaxParts,t["part-number-marker"]=e.PartNumberMarker,d.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(e,t){if(e)return o&&o.parent&&o.parent.setParams({errorNode:"multipartListPart"}),r(e);var n=t.ListPartsResult||{},e=n.Part||[],e=C.isArray(e)?e:[e];n.Part=e;n=C.clone(n);C.extend(n,{statusCode:t.statusCode,headers:t.headers}),r(null,n)})},multipartAbort:function(e,n){var t={};t.uploadId=e.UploadId,d.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:t},function(e,t){return e?n(e):void n(null,{statusCode:t.statusCode,headers:t.headers})})},request:function(e,n){d.call(this,{method:e.Method,Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:e.Action,headers:e.Headers,qs:e.Query,body:e.Body,Url:e.Url,rawBody:e.RawBody,DataType:e.DataType},function(e,t){return e?n(e):(t&&t.body&&(t.Body=t.body,delete t.body),void n(e,t))})},getObjectUrl:function(e,i){var t=this,n=(void 0===e.UseAccelerate?t.options:e).UseAccelerate,a=g({ForcePathStyle:t.options.ForcePathStyle,protocol:e.Protocol||t.options.Protocol,domain:e.Domain||t.options.Domain,bucket:e.Bucket,region:n?"accelerate":e.Region,object:e.Key}),s="";e.Query&&(s+=C.obj2str(e.Query)),e.QueryString&&(s+=(s?"&":"")+e.QueryString);var r=a;if(void 0!==e.Sign&&!e.Sign)return s&&(r+="?"+s),i(null,{Url:r}),r;n=o.call(this,{Bucket:e.Bucket,Region:e.Region,UseAccelerate:e.UseAccelerate,Url:a}),t=l.call(this,{Action:"PUT"===(e.Method||"").toUpperCase()?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires,Headers:e.Headers,Query:e.Query,SignHost:n,ForceSignHost:!1!==e.ForceSignHost&&t.options.ForceSignHost},function(e,t){var n,r,o;i&&(e?i(e):(n=a,n+="?"+(-1<t.Authorization.indexOf("q-signature")?(r=t.Authorization,o=r.match(/q-url-param-list.*?(?=&)/g)[0],e="q-url-param-list="+encodeURIComponent(o.replace(/q-url-param-list=/,"")).toLowerCase(),o=new RegExp(o,"g"),r.replace(o,e)):"sign="+encodeURIComponent(t.Authorization)),t.SecurityToken&&(n+="&x-cos-security-token="+t.SecurityToken),t.ClientIP&&(n+="&clientIP="+t.ClientIP),t.ClientUA&&(n+="&clientUA="+t.ClientUA),t.Token&&(n+="&token="+t.Token),s&&(n+="&"+s),setTimeout(function(){i(null,{Url:n})})))});return t?(r+="?"+t.Authorization+(t.SecurityToken?"&x-cos-security-token="+t.SecurityToken:""),s&&(r+="&"+s)):s&&(r+="?"+s),r},getAuth:function(e){return C.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Bucket:e.Bucket,Region:e.Region,Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:this.options.UseRawKey,SystemClockOffset:this.options.SystemClockOffset})}};e.exports.init=function(i,e){e.transferToTaskMethod(r,"putObject"),C.each(r,function(e,t){var n,r,o;i.prototype[t]=C.apiWrapper(t,e),n=t,r=e,o=i.prototype,C.each(["Cors","Acl"],function(e){var t;n.slice(-e.length)===e&&(e=n.slice(0,-e.length)+e.toUpperCase(),t=C.apiWrapper(n,r),o[e]=function(){t.apply(this,arguments)})})})}},function(e,t,n){function l(e){switch(h(e)){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function d(e,t,n){var r={};return t.getAllResponseHeaders().trim().split("\n").forEach(function(e){var t,n;e&&(n=e.indexOf(":"),t=e.substr(0,n).trim().toLowerCase(),n=e.substr(n+1).trim(),r[t]=n)}),{error:e,statusCode:t.status,statusMessage:t.statusText,headers:r,body:n}}function p(e,t){return t||"text"!==t?e.response:e.responseText}var h=n(0);e.exports=function(r,o){var n,e,t=(r.method||"GET").toUpperCase(),i=r.url;r.qs&&(n=r.qs,(e="object"===h(n=null===n?void 0:n)?Object.keys(n).map(function(e){var t=encodeURIComponent(l(e))+"=";return Array.isArray(n[e])?n[e].map(function(e){return t+encodeURIComponent(l(e))}).join("&"):t+encodeURIComponent(l(n[e]))}).filter(Boolean).join("&"):"")&&(i+=(-1===i.indexOf("?")?"?":"&")+e));var a=new XMLHttpRequest;if(a.open(t,i,!0),a.responseType=r.dataType||"text",r.xhrFields)for(var s in r.xhrFields)a[s]=r.xhrFields[s];var c=r.headers;if(c)for(var u in c)c.hasOwnProperty(u)&&"content-length"!==u.toLowerCase()&&"user-agent"!==u.toLowerCase()&&"origin"!==u.toLowerCase()&&"host"!==u.toLowerCase()&&a.setRequestHeader(u,c[u]);return r.onProgress&&a.upload&&(a.upload.onprogress=r.onProgress),r.onDownloadProgress&&(a.onprogress=r.onDownloadProgress),r.timeout&&(a.timeout=r.timeout),a.ontimeout=function(e){var t=new Error("timeout");o(d(t,a))},a.onload=function(){o(d(null,a,p(a,r.dataType)))},a.onerror=function(e){var t,n=p(a,r.dataType);n?o(d(null,a,n)):((t=a.statusText)||0!==a.status||(t=new Error("CORS blocked or network error")),o(d(t,a,n)))},a.send(r.body||""),a}},function(e,t,n){var g=n(0),T=n(9),R=n(29),E=n(8).EventProxy,w=n(1),y=n(6);function v(d,i){function a(c,u){var l=c.length;return 0===l?u(null,!0):g<l||1<l&&Math.max(c[0].Size,c[1].Size)!==m?u(null,!1):void function n(r){var o,i,a,e,t,s;r<l?(o=c[r],i=o.PartNumber,a=function(e,t){t&&t.ETag===o.ETag&&t.Size===o.Size?n(r+1):u(null,!1)},e=m*(i-1),t=Math.min(e+m,f),s=t-e,h[i]?a(0,{PartNumber:i,ETag:h[i],Size:s}):w.fileSlice(d.Body,e,t,!1,function(e){w.getFileMd5(e,function(e,t){if(e)return a(w.error(e));t='"'+t+'"';h[i]=t,v({loaded:y+=s,total:f}),a(0,{PartNumber:i,ETag:t,Size:s})})})):u(null,!0)}(0)}var s=d.TaskId,c=d.Bucket,u=d.Region,l=d.Key,r=d.StorageClass,p=this,h={},f=d.FileSize,m=d.SliceSize,g=Math.ceil(f/m),y=0,v=w.throttleOnProgress.call(p,f,d.onHashProgress),C=new E;C.on("error",function(e){if(p._isRunningTask(s))return i(e)}),C.on("upload_id_available",function(e){var t={},n=[];w.each(e.PartList,function(e){t[e.PartNumber]=e});for(var r=1;r<=g;r++){var o=t[r];o?(o.PartNumber=r,o.Uploaded=!0):o={PartNumber:r,ETag:null,Uploaded:!1},n.push(o)}e.PartList=n,i(null,e)}),C.on("no_available_upload_id",function(){var e,t;p._isRunningTask(s)&&(e=w.extend({Bucket:c,Region:u,Key:l,Query:w.clone(d.Query),StorageClass:r,Body:d.Body,calledBySdk:"sliceUploadFile",tracker:d.tracker},d),delete(t=w.clone(d.Headers))["x-cos-mime-limit"],e.Headers=t,p.multipartInit(e,function(e,t){if(p._isRunningTask(s)){if(e)return C.emit("error",e);t=t.UploadId;if(!t)return i(w.error(new Error("no such upload id")));C.emit("upload_id_available",{UploadId:t,PartList:[]})}}))}),C.on("has_and_check_upload_id",function(e){e=e.reverse(),R.eachLimit(e,1,function(r,o){p._isRunningTask(s)&&(T.using[r]?o():x.call(p,{Bucket:c,Region:u,Key:l,UploadId:r,tracker:d.tracker},function(e,t){if(p._isRunningTask(s)){if(e)return T.removeUsing(r),C.emit("error",e);var n=t.PartList;n.forEach(function(e){e.PartNumber*=1,e.Size*=1,e.ETag=e.ETag||""}),a(n,function(e,t){if(p._isRunningTask(s))return e?C.emit("error",e):void(t?o({UploadId:r,PartList:n}):o())})}}))},function(e){p._isRunningTask(s)&&(v(null,!0),e&&e.UploadId?C.emit("upload_id_available",e):C.emit("no_available_upload_id"))})}),C.on("seek_local_avail_upload_id",function(e){var t=T.getFileId(d.Body,d.ChunkSize,c,l),i=T.getUploadIdList.call(p,t);t&&i?function n(r){if(r>=i.length)C.emit("has_and_check_upload_id",e);else{var o=i[r];if(!w.isInArray(e,o))return T.removeUploadId.call(p,o),void n(r+1);T.using[o]?n(r+1):x.call(p,{Bucket:c,Region:u,Key:l,UploadId:o,tracker:d.tracker},function(e,t){p._isRunningTask(s)&&(e?(T.removeUploadId.call(p,o),n(r+1)):C.emit("upload_id_available",{UploadId:o,PartList:t.PartList}))})}}(0):C.emit("has_and_check_upload_id",e)}),C.on("get_remote_upload_id_list",function(){k.call(p,{Bucket:c,Region:u,Key:l,tracker:d.tracker},function(e,t){if(p._isRunningTask(s)){if(e)return C.emit("error",e);var n,t=w.filter(t.UploadList,function(e){return e.Key===l&&(!r||e.StorageClass.toUpperCase()===r.toUpperCase())}).reverse().map(function(e){return e.UploadId||e.UploadID});t.length?C.emit("seek_local_avail_upload_id",t):((t=T.getFileId(d.Body,d.ChunkSize,c,l))&&(n=T.getUploadIdList.call(p,t))&&w.each(n,function(e){T.removeUploadId.call(p,e)}),C.emit("no_available_upload_id"))}})}),C.emit("get_remote_upload_id_list")}function k(e,r){var t=this,o=[],i={Bucket:e.Bucket,Region:e.Region,Prefix:e.Key,calledBySdk:e.calledBySdk||"sliceUploadFile",tracker:e.tracker};!function n(){t.multipartList(i,function(e,t){return e?r(e):(o.push.apply(o,t.Upload||[]),void("true"===t.IsTruncated?(i.KeyMarker=t.NextKeyMarker,i.UploadIdMarker=t.NextUploadIdMarker,n()):r(null,{UploadList:o})))})}()}function x(e,r){var t=this,o=[],i={Bucket:e.Bucket,Region:e.Region,Key:e.Key,UploadId:e.UploadId,calledBySdk:"sliceUploadFile",tracker:e.tracker};!function n(){t.multipartListPart(i,function(e,t){return e?r(e):(o.push.apply(o,t.Part||[]),void("true"===t.IsTruncated?(i.PartNumberMarker=t.NextPartNumberMarker,n()):r(null,{PartList:o})))})}()}function C(t,n){var a=this,s=t.TaskId,c=t.Bucket,u=t.Region,l=t.Key,d=t.UploadData,p=t.FileSize,h=t.SliceSize,e=Math.min(t.AsyncLimit||a.options.ChunkParallelLimit||1,256),f=t.Body,r=Math.ceil(p/h),m=0,g=t.ServerSideEncryption,y=t.Headers,o=w.filter(d.PartList,function(e){return e.Uploaded&&(m+=e.PartNumber>=r&&p%h||h),!e.Uploaded}),v=t.onProgress;R.eachLimit(o,e,function(n,r){var e,o,i;a._isRunningTask(s)&&(e=n.PartNumber,o=Math.min(p,n.PartNumber*h)-(n.PartNumber-1)*h,i=0,function(t,n){var r=this,o=t.TaskId,i=t.Bucket,a=t.Region,s=t.Key,e=t.FileSize,c=t.Body,u=+t.PartNumber,l=t.SliceSize,d=t.ServerSideEncryption,p=t.UploadData,h=t.Headers||{},f=r.options.ChunkRetryTimes+1,m=l*(u-1),g=l,y=m+l;e<y&&(g=(y=e)-m);var v=["x-cos-traffic-limit","x-cos-mime-limit"],C={};w.each(h,function(e,t){-1<v.indexOf(t)&&(C[t]=e)});var k=p.PartList[u-1];R.retry(f,function(n){r._isRunningTask(o)&&w.fileSlice(c,m,y,!0,function(e){r.multipartUpload({TaskId:o,Bucket:i,Region:a,Key:s,ContentLength:g,PartNumber:u,UploadId:p.UploadId,ServerSideEncryption:d,Body:e,Headers:C,onProgress:t.onProgress,calledBySdk:"sliceUploadFile",tracker:t.tracker},function(e,t){if(r._isRunningTask(o))return e?n(e):(k.Uploaded=!0,n(null,t))})})},function(e,t){if(r._isRunningTask(o))return n(e,t)})}.call(a,{TaskId:s,Bucket:c,Region:u,Key:l,SliceSize:h,FileSize:p,PartNumber:e,ServerSideEncryption:g,Body:f,UploadData:d,Headers:y,onProgress:function(e){m+=e.loaded-i,i=e.loaded,v({loaded:m,total:p})},tracker:t.tracker},function(e,t){a._isRunningTask(s)&&((e=!e&&!t.ETag?'get ETag error, please add "ETag" to CORS ExposeHeader setting.( 获取ETag失败，请在CORS ExposeHeader设置中添加ETag，请参考文档：https://cloud.tencent.com/document/product/436/13318 )':e)?m-=i:(m+=o-i,n.ETag=t.ETag),v({loaded:m,total:p}),r(e||null,t))}))},function(e){if(a._isRunningTask(s))return e?n(e):void n(null,{UploadId:d.UploadId,SliceList:d.PartList})})}var r={sliceUploadFile:function(o,t){var i,a,s=this,c=new E,u=o.TaskId,l=o.Bucket,d=o.Region,p=o.Key,n=o.Body,r=o.ChunkSize||o.SliceSize||s.options.ChunkSize,h=o.AsyncLimit,f=o.StorageClass,m=o.ServerSideEncryption,g=o.onHashProgress,y=o.tracker;y&&y.setParams({chunkSize:r}),c.on("error",function(e){if(s._isRunningTask(u))return e.UploadId=o.UploadData.UploadId||"",t(e)}),c.on("upload_complete",function(e){e=w.extend({UploadId:o.UploadData.UploadId||""},e);t(null,e)}),c.on("upload_slice_complete",function(n){var r={};w.each(o.Headers,function(e,t){var n=t.toLowerCase();0!==n.indexOf("x-cos-meta-")&&"pic-operations"!==n||(r[t]=e)}),function(t,n){var r=t.Bucket,o=t.Region,i=t.Key,a=t.UploadId,e=t.SliceList,s=this,c=this.options.ChunkRetryTimes+1,u=t.Headers,l=e.map(function(e){return{PartNumber:e.PartNumber,ETag:e.ETag}});R.retry(c,function(e){s.multipartComplete({Bucket:r,Region:o,Key:i,UploadId:a,Parts:l,Headers:u,calledBySdk:"sliceUploadFile",tracker:t.tracker},e)},function(e,t){n(e,t)})}.call(s,{Bucket:l,Region:d,Key:p,UploadId:n.UploadId,SliceList:n.SliceList,Headers:r,tracker:y},function(e,t){if(s._isRunningTask(u)){if(T.removeUsing(n.UploadId),e)return a(null,!0),c.emit("error",e);T.removeUploadId.call(s,n.UploadId),a({loaded:i,total:i},!0),c.emit("upload_complete",t)}})}),c.on("get_upload_data_finish",function(e){var t=T.getFileId(n,o.ChunkSize,l,p);t&&T.saveUploadId.call(s,t,e.UploadId,s.options.UploadIdCacheLimit),T.setUsing(e.UploadId),a(null,!0),C.call(s,{TaskId:u,Bucket:l,Region:d,Key:p,Body:n,FileSize:i,SliceSize:r,AsyncLimit:h,ServerSideEncryption:m,UploadData:e,Headers:o.Headers,onProgress:a,tracker:y},function(e,t){if(s._isRunningTask(u))return e?(a(null,!0),c.emit("error",e)):void c.emit("upload_slice_complete",t)})}),c.on("get_file_size_finish",function(){var e;a=w.throttleOnProgress.call(s,i,o.onProgress),o.UploadData.UploadId?c.emit("get_upload_data_finish",o.UploadData):(e=w.extend({TaskId:u,Bucket:l,Region:d,Key:p,Headers:o.Headers,StorageClass:f,Body:n,FileSize:i,SliceSize:r,onHashProgress:g,tracker:y},o),v.call(s,e,function(e,t){if(s._isRunningTask(u)){if(e)return c.emit("error",e);o.UploadData.UploadId=t.UploadId,o.UploadData.PartList=t.PartList,c.emit("get_upload_data_finish",o.UploadData)}}))}),i=o.ContentLength,delete o.ContentLength,o.Headers||(o.Headers={}),w.each(o.Headers,function(e,t){"content-length"===t.toLowerCase()&&delete o.Headers[t]}),function(){for(var e=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],t=1048576,n=0;n<e.length&&!(i/(t=1024*e[n]*1024)<=s.options.MaxPartNumber);n++);o.ChunkSize=o.SliceSize=r=Math.max(r,t)}(),0===i?(o.Body="",o.ContentLength=0,o.SkipTask=!0,s.putObject(o,t)):c.emit("get_file_size_finish")},abortUploadTask:function(t,n){var r=t.Bucket,o=t.Region,i=t.Key,e=t.UploadId,a=t.Level||"task",s=t.AsyncLimit,c=this,u=new E;if(u.on("error",function(e){return n(e)}),u.on("get_abort_array",function(e){!function(e,a){var s=e.Bucket,c=e.Region,t=e.Key,n=e.AbortArray,r=e.AsyncLimit||1,u=this,l=0,d=new Array(n.length);R.eachLimit(n,r,function(n,r){var o=l;if(t&&t!==n.Key)return d[o]={error:{KeyNotMatch:!0}},void r(null);var i=n.UploadId||n.UploadID;u.multipartAbort({Bucket:s,Region:c,Key:n.Key,Headers:e.Headers,UploadId:i},function(e){var t={Bucket:s,Region:c,Key:n.Key,UploadId:i};d[o]={error:e,task:t},r(null)}),l++},function(e){if(e)return a(e);for(var t=[],n=[],r=0,o=d.length;r<o;r++){var i=d[r];i.task&&(i.error?n:t).push(i.task)}return a(null,{successList:t,errorList:n})})}.call(c,{Bucket:r,Region:o,Key:i,Headers:t.Headers,AsyncLimit:s,AbortArray:e},n)}),"bucket"===a)k.call(c,{Bucket:r,Region:o,calledBySdk:"abortUploadTask"},function(e,t){return e?n(e):void u.emit("get_abort_array",t.UploadList||[])});else{if("file"!==a)return"task"!==a?n(w.error(new Error("abort_unknown_level"))):e?i?void u.emit("get_abort_array",[{Key:i,UploadId:e}]):n(w.error(new Error("abort_upload_task_no_key"))):n(w.error(new Error("abort_upload_task_no_id")));{if(!i)return n(w.error(new Error("abort_upload_task_no_key")));k.call(c,{Bucket:r,Region:o,Key:i,calledBySdk:"abortUploadTask"},function(e,t){return e?n(e):void u.emit("get_abort_array",t.UploadList||[])})}}},uploadFile:function(n,r){var e=this,t=(void 0===n.SliceSize?e.options:n).SliceSize,o=[],i=n.Body,a=i.size||i.length||0,s={TaskId:""};e.options.EnableTracker&&(i=e.options.UseAccelerate||"string"==typeof e.options.Domain&&e.options.Domain.includes("accelerate."),n.tracker=new y({bucket:n.Bucket,region:n.Region,apiName:"uploadFile",fileKey:n.Key,fileSize:a,accelerate:i,deepTracker:e.options.DeepTracker,customId:e.options.CustomId,delay:e.options.TrackerDelay})),w.each(n,function(e,t){"object"!==g(e)&&"function"!=typeof e&&(s[t]=e)});var c=n.onTaskReady;n.onTaskReady=function(e){s.TaskId=e,c&&c(e)};var u=n.onFileFinish;o.push({api:t<a?"sliceUploadFile":"putObject",params:n,callback:function(e,t){n.tracker&&n.tracker.formatResult(e,t),u&&u(e,t,s),r&&r(e,t)}}),e._addTasks(o)},uploadFiles:function(e,r){function u(e,t,n){f(null,!0),i&&i(e,t,n),a[n.Index]={options:n,error:e,data:t},--o<=0&&r&&r(null,{files:a})}var l=this,d=(void 0===e.SliceSize?l.options:e).SliceSize,p=0,h=0,f=w.throttleOnProgress.call(l,h,e.onProgress),o=e.files.length,i=e.onFileFinish,a=Array(o),m=[];w.each(e.files,function(s,c){!function(){var e=s.Body,t=e.size||e.length||0,n={Index:c,TaskId:""};p+=t,l.options.EnableTracker&&(e=l.options.UseAccelerate||"string"==typeof l.options.Domain&&l.options.Domain.includes("accelerate."),s.tracker=new y({bucket:s.Bucket,region:s.Region,apiName:"uploadFiles",fileKey:s.Key,fileSize:t,accelerate:e,deepTracker:l.options.DeepTracker,customId:l.options.CustomId,delay:l.options.TrackerDelay})),w.each(s,function(e,t){"object"!==g(e)&&"function"!=typeof e&&(n[t]=e)});var r=s.onTaskReady;s.onTaskReady=function(e){n.TaskId=e,r&&r(e)};var o=0,i=s.onProgress;s.onProgress=function(e){h=h-o+e.loaded,o=e.loaded,i&&i(e),f({loaded:h,total:p})};var a=s.onFileFinish;m.push({api:d<t?"sliceUploadFile":"putObject",params:s,callback:function(e,t){s.tracker&&s.tracker.formatResult(e,t),a&&a(e,t),u(e,t,n)}})}()}),l._addTasks(m)},sliceCopyFile:function(s,o){var e,t,n,r,c,u,l,i,d,p,h,f,a,m,g=new E,y=this,v=s.Bucket,C=s.Region,k=s.Key,S=s.CopySource,b=w.getSourceParams.call(this,S);b?(e=b.Bucket,t=b.Region,n=decodeURIComponent(b.Key),r=(void 0===s.CopySliceSize?y.options:s).CopySliceSize,r=Math.max(0,r),l=s.CopyChunkSize||this.options.CopyChunkSize,i=this.options.CopyChunkParallelLimit,d=this.options.ChunkRetryTimes+1,h=p=0,f={},a={},m={},g.on("copy_slice_complete",function(n){var r={};w.each(s.Headers,function(e,t){0===t.toLowerCase().indexOf("x-cos-meta-")&&(r[t]=e)});var t=w.map(n.PartList,function(e){return{PartNumber:e.PartNumber,ETag:e.ETag}});R.retry(d,function(e){y.multipartComplete({Bucket:v,Region:C,Key:k,UploadId:n.UploadId,Parts:t,calledBySdk:"sliceCopyFile"},e)},function(e,t){return T.removeUsing(n.UploadId),e?(u(null,!0),o(e)):(T.removeUploadId(n.UploadId),u({loaded:c,total:c},!0),void o(null,t))})}),g.on("get_copy_data_finish",function(a){var e=T.getCopyFileId(S,f,l,v,k);e&&T.saveUploadId(e,a.UploadId,y.options.UploadIdCacheLimit),T.setUsing(a.UploadId);e=w.filter(a.PartList,function(e){return e.Uploaded&&(h+=e.PartNumber>=p&&c%l||l),!e.Uploaded});R.eachLimit(e,i,function(n,r){var t=n.PartNumber,o=n.CopySourceRange,i=n.end-n.start;R.retry(d,function(e){!function(e,n){var t=e.TaskId,r=e.Bucket,o=e.Region,i=e.Key,a=e.CopySource,s=e.UploadId,c=+e.PartNumber,u=e.CopySourceRange,e=this.options.ChunkRetryTimes+1,l=this;R.retry(e,function(n){l.uploadPartCopy({TaskId:t,Bucket:r,Region:o,Key:i,CopySource:a,UploadId:s,PartNumber:c,CopySourceRange:u},function(e,t){n(e||null,t)})},function(e,t){return n(e,t)})}.call(y,{Bucket:v,Region:C,Key:k,CopySource:S,UploadId:a.UploadId,PartNumber:t,CopySourceRange:o},e)},function(e,t){return e?r(e):(u({loaded:h+=i,total:c}),n.ETag=t.ETag,void r(e||null,t))})},function(e){return e?(T.removeUsing(a.UploadId),u(null,!0),o(e)):void g.emit("copy_slice_complete",a)})}),g.on("get_chunk_size_finish",function(){function e(){y.multipartInit({Bucket:v,Region:C,Key:k,Headers:m},function(e,t){return e?o(e):(s.UploadId=t.UploadId,void g.emit("get_copy_data_finish",{UploadId:s.UploadId,PartList:s.PartList}))})}var t=T.getCopyFileId(S,f,l,v,k),r=T.getUploadIdList(t);if(!t||!r)return e();!function n(i){if(i>=r.length)return e();var a=r[i];if(T.using[a])return n(i+1);x.call(y,{Bucket:v,Region:C,Key:k,UploadId:a},function(e,t){if(e)T.removeUploadId(a),n(i+1);else{if(T.using[a])return n(i+1);var r={},o=0;w.each(t.PartList,function(e){var t=parseInt(e.Size),n=o+t-1;r[e.PartNumber+"|"+o+"|"+n]=e.ETag,o+=t}),w.each(s.PartList,function(e){var t=r[e.PartNumber+"|"+e.start+"|"+e.end];t&&(e.ETag=t,e.Uploaded=!0)}),g.emit("get_copy_data_finish",{UploadId:a,PartList:s.PartList})}})}(0)}),g.on("get_file_size_finish",function(){if(function(){for(var e=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],t=1048576,n=0;n<e.length&&!(c/(t=1024*e[n]*1024)<=y.options.MaxPartNumber);n++);s.ChunkSize=l=Math.max(l,t),p=Math.ceil(c/l);for(var r=[],o=1;o<=p;o++){var i=(o-1)*l,a=o*l<c?o*l-1:c-1;r.push({PartNumber:o,start:i,end:a,CopySourceRange:"bytes="+i+"-"+a})}s.PartList=r}(),(m="Replaced"===s.Headers["x-cos-metadata-directive"]?s.Headers:a)["x-cos-storage-class"]=s.Headers["x-cos-storage-class"]||a["x-cos-storage-class"],m=w.clearKey(m),"ARCHIVE"===a["x-cos-storage-class"]||"DEEP_ARCHIVE"===a["x-cos-storage-class"]){var e=a["x-cos-restore"];if(!e||'ongoing-request="true"'===e)return void o(w.error(new Error("Unrestored archive object is not allowed to be copied")))}delete m["x-cos-copy-source"],delete m["x-cos-metadata-directive"],delete m["x-cos-copy-source-If-Modified-Since"],delete m["x-cos-copy-source-If-Unmodified-Since"],delete m["x-cos-copy-source-If-Match"],delete m["x-cos-copy-source-If-None-Match"],g.emit("get_chunk_size_finish")}),y.headObject({Bucket:e,Region:t,Key:n},function(e,t){e?e.statusCode&&404===e.statusCode?o(w.error(e,{ErrorStatus:n+" Not Exist"})):o(e):void 0!==(c=s.FileSize=t.headers["content-length"])&&c?(u=w.throttleOnProgress.call(y,c,s.onProgress),c<=r?(s.Headers["x-cos-metadata-directive"]||(s.Headers["x-cos-metadata-directive"]="Copy"),y.putObjectCopy(s,function(e,t){return e?(u(null,!0),o(e)):(u({loaded:c,total:c},!0),void o(e,t))})):(t=t.headers,a={"Cache-Control":(f=t)["cache-control"],"Content-Disposition":t["content-disposition"],"Content-Encoding":t["content-encoding"],"Content-Type":t["content-type"],Expires:t.expires,"x-cos-storage-class":t["x-cos-storage-class"]},w.each(t,function(e,t){var n="x-cos-meta-";0===t.indexOf(n)&&t.length>n.length&&(a[t]=e)}),g.emit("get_file_size_finish"))):o(w.error(new Error('get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.（ 获取Content-Length失败，请在CORS ExposeHeader设置中添加Content-Length，请参考文档：https://cloud.tencent.com/document/product/436/13318 ）')))})):o(w.error(new Error("CopySource format error")))}};e.exports.init=function(n,e){e.transferToTaskMethod(r,"sliceUploadFile"),w.each(r,function(e,t){n.prototype[t]=w.apiWrapper(t,e)})}},function(e,t){e.exports={eachLimit:function(n,e,r,o){if(o=o||function(){},!n.length||e<=0)return o();var i=0,a=0,s=0;!function t(){if(i>=n.length)return o();for(;s<e&&a<n.length;)s+=1,r(n[(a+=1)-1],function(e){e?(o(e),o=function(){}):(--s,((i+=1)>=n.length?o:t)())})}()},retry:function(o,e,i){o<1?i():function n(r){e(function(e,t){e&&r<o?n(r+1):i(e,t)})}(1)}}}],d={},e.m=c,e.c=d,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(e){return t[e]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="/dist/",e(e.s=10);function e(t){if(d[t])return d[t].exports;var n=d[t]={i:t,l:!1,exports:{}};return c[t].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var c,d});